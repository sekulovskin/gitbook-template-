<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Hands-on examples using bain | A GitBook template</title>
  <meta name="description" content="Chapter 3 Hands-on examples using bain | A GitBook template" />
  <meta name="generator" content="bookdown 0.24.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Hands-on examples using bain | A GitBook template" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="sekulovskin/gitbook-template-" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Hands-on examples using bain | A GitBook template" />
  
  
  

<meta name="author" content="Nikola Sekulovski" />


<meta name="date" content="2021-10-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-bain.html"/>
<link rel="next" href="sensitivity-analysis-using-bain.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Gitbook template</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="monte-carlo-simulations.html"><a href="monte-carlo-simulations.html"><i class="fa fa-check"></i><b>1</b> Monte Carlo Simulations</a>
<ul>
<li class="chapter" data-level="1.1" data-path="monte-carlo-simulations.html"><a href="monte-carlo-simulations.html#the-confidence-interval"><i class="fa fa-check"></i><b>1.1</b> The Confidence Interval</a></li>
<li class="chapter" data-level="1.2" data-path="monte-carlo-simulations.html"><a href="monte-carlo-simulations.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>1.2</b> The Central Limit Theorem</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="equations-picture.html"><a href="equations-picture.html"><i class="fa fa-check"></i><b>2</b> Equations &amp; Picture</a>
<ul>
<li class="chapter" data-level="2.1" data-path="equations-picture.html"><a href="equations-picture.html#bayes-theorem"><i class="fa fa-check"></i><b>2.1</b> Bayes’ theorem</a></li>
<li class="chapter" data-level="2.2" data-path="equations-picture.html"><a href="equations-picture.html#normal-pdf"><i class="fa fa-check"></i><b>2.2</b> Normal PDF</a></li>
<li class="chapter" data-level="2.3" data-path="equations-picture.html"><a href="equations-picture.html#picture"><i class="fa fa-check"></i><b>2.3</b> Picture</a></li>
</ul></li>
<li class="part"><span><b>I <code>R</code> package <code>bain</code></b></span></li>
<li><a href="introduction-to-bain.html#introduction-to-bain">Introduction to <code>bain</code></a>
<ul>
<li class="chapter" data-level="2.4" data-path="introduction-to-bain.html"><a href="introduction-to-bain.html"><i class="fa fa-check"></i><b>2.4</b> Available tutorials</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-bain.html"><a href="introduction-to-bain.html#usage"><i class="fa fa-check"></i><b>2.5</b> Usage</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduction-to-bain.html"><a href="introduction-to-bain.html#arguments"><i class="fa fa-check"></i><b>2.5.1</b> Arguments</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction-to-bain.html"><a href="introduction-to-bain.html#the-specification-of-hypotheses"><i class="fa fa-check"></i><b>2.5.2</b> The specification of <code>hypotheses</code></a></li>
<li class="chapter" data-level="2.5.3" data-path="introduction-to-bain.html"><a href="introduction-to-bain.html#output"><i class="fa fa-check"></i><b>2.5.3</b> Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html"><i class="fa fa-check"></i><b>3</b> Hands-on examples using <code>bain</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#using-bain-with-a-t_test-object"><i class="fa fa-check"></i><b>3.1</b> Using <code>bain</code> with a <code>t_test</code> object</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#students-t-test-equal-within-group-variances"><i class="fa fa-check"></i><b>3.1.1</b> Student’s t-test (equal within group variances):</a></li>
<li class="chapter" data-level="3.1.2" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#welchs-t-test-unequal-within-group-variances"><i class="fa fa-check"></i><b>3.1.2</b> Welch’s t-test (unequal within group variances):</a></li>
<li class="chapter" data-level="3.1.3" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#paired-samples-t-test"><i class="fa fa-check"></i><b>3.1.3</b> Paired samples t-test:</a></li>
<li class="chapter" data-level="3.1.4" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#one-group-t-test"><i class="fa fa-check"></i><b>3.1.4</b> One group t-test</a></li>
<li class="chapter" data-level="3.1.5" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#equivalence-test"><i class="fa fa-check"></i><b>3.1.5</b> Equivalence test</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#using-bain-with-a-lm-object"><i class="fa fa-check"></i><b>3.2</b> Using <code>bain</code> with a <code>lm</code> object</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#anova"><i class="fa fa-check"></i><b>3.2.1</b> ANOVA</a></li>
<li class="chapter" data-level="3.2.2" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#ancova"><i class="fa fa-check"></i><b>3.2.2</b> ANCOVA</a></li>
<li class="chapter" data-level="3.2.3" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#multiple-regression"><i class="fa fa-check"></i><b>3.2.3</b> Multiple regression</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#lavaan"><i class="fa fa-check"></i><b>3.3</b> Using <code>bain</code> with a <code>lavaan</code> object</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#confirmatory-factor-analysis-cfa"><i class="fa fa-check"></i><b>3.3.1</b> Confirmatory Factor Analysis (CFA):</a></li>
<li class="chapter" data-level="3.3.2" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#latent-regression"><i class="fa fa-check"></i><b>3.3.2</b> Latent regression</a></li>
<li class="chapter" data-level="3.3.3" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#multiple-group-regression"><i class="fa fa-check"></i><b>3.3.3</b> Multiple group regression</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#named"><i class="fa fa-check"></i><b>3.4</b> Using <code>bain</code> with a named vector</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#anova-1"><i class="fa fa-check"></i><b>3.4.1</b> ANOVA</a></li>
<li class="chapter" data-level="3.4.2" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#welchs-anova-equal-variances-not-assumed"><i class="fa fa-check"></i><b>3.4.2</b> Welch’s ANOVA (equal variances not assumed)</a></li>
<li class="chapter" data-level="3.4.3" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#robust-anova-against-non-normality"><i class="fa fa-check"></i><b>3.4.3</b> Robust ANOVA (against non-normality)</a></li>
<li class="chapter" data-level="3.4.4" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#ancova-1"><i class="fa fa-check"></i><b>3.4.4</b> ANCOVA</a></li>
<li class="chapter" data-level="3.4.5" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#one-within-factor-repeated-measures-analysis"><i class="fa fa-check"></i><b>3.4.5</b> One within factor repeated measures analysis</a></li>
<li class="chapter" data-level="3.4.6" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#one-between-within-factor-repeated-measures-analysis"><i class="fa fa-check"></i><b>3.4.6</b> One between-within factor repeated measures analysis</a></li>
<li class="chapter" data-level="3.4.7" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#logistic-regression-1"><i class="fa fa-check"></i><b>3.4.7</b> Logistic regression (1)</a></li>
<li class="chapter" data-level="3.4.8" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#logistic-regression-2"><i class="fa fa-check"></i><b>3.4.8</b> Logistic regression (2)</a></li>
<li class="chapter" data-level="3.4.9" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#cfa"><i class="fa fa-check"></i><b>3.4.9</b> CFA</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="hands-on-examples-using-bain.html"><a href="hands-on-examples-using-bain.html#using-bain-with-missing-data"><i class="fa fa-check"></i><b>3.5</b> Using <code>bain</code> with missing data:</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sensitivity-analysis-using-bain.html"><a href="sensitivity-analysis-using-bain.html"><i class="fa fa-check"></i><b>4</b> Sensitivity analysis using <code>bain</code></a>
<ul>
<li class="chapter" data-level="4.1" data-path="sensitivity-analysis-using-bain.html"><a href="sensitivity-analysis-using-bain.html#an-example-using-anova"><i class="fa fa-check"></i><b>4.1</b> An example using ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="" data-path="appendix-a.html"><a href="appendix-a.html"><i class="fa fa-check"></i>Appendix A</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A GitBook template</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hands-on-examples-using-bain" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Hands-on examples using <code>bain</code></h1>
<p>Unless indicated otherwise, the examples that follow below use a simulated
data set inspired by the <code>Sesame Street</code> data set presented in:
<span class="citation"><a href="references.html#ref-stevens1996applied" role="doc-biblioref">Stevens</a> (<a href="references.html#ref-stevens1996applied" role="doc-biblioref">1996</a>)</span>. This data set is included in the
<code>bain</code> package.</p>
<p>The variables contained in <code>sesamesim</code> are subsequently:</p>
<ul>
<li><code>sex</code> (1 = boy, 2 = girl) of the child</li>
<li><code>site</code> (1 = disadvantaged inner city, 2 = advantaged suburban , 3 =
advantaged rural,
4 = disadvantaged rural, 5 = disadvantaged Spanish speaking) from which
the child originates</li>
<li><code>settin</code>g (1 = at home, 2 = at school) in which the child watches sesame
street</li>
<li><code>age</code> (in months) of the child</li>
<li><code>viewenc</code> (0 = no, 1 = yes), whether or not the child is encouraged to
watch Sesame Street</li>
<li><code>peabody</code> (mental age) score of the child (higher score is higher mental
age)</li>
<li><code>prenumb</code> (score on a numbers test before watching Sesame Street for a
year)</li>
<li><code>postnumb</code> (score on a numbers test after watching Sesame Street for a
year)</li>
<li><code>funumb</code> (follow up numbers test score measured one year after postnumb)</li>
<li><code>Bb</code> Knowledge of body parts before</li>
<li><code>Bl</code> Knowledge of letters before</li>
<li><code>Bf</code> Knowledge of forms before</li>
<li><code>Bn</code> Knowledge of numbers before</li>
<li><code>Br</code> Knowledge of relations before</li>
<li><code>Bc</code> Knowledge of classifications before</li>
<li><code>Ab</code> Knowledge of body parts after</li>
<li><code>Al</code> Knowledge of letters after</li>
<li><code>Af</code> Knowledge of forms after</li>
<li><code>An</code> Knowledge of numbers after</li>
<li><code>Ar</code> Knowledge of relations after</li>
<li><code>Ac</code> Knowledge of classifications after</li>
</ul>
<p>The examples that follow below are organized in four categories:</p>
<ol style="list-style-type: decimal">
<li>running <code>bain</code> with a <code>t_test</code> object</li>
<li>running <code>bain</code> with a <code>lm</code> object</li>
<li>running <code>bain</code> with a <code>lavaan</code> object</li>
<li>running bain with a named vector</li>
</ol>
<p>Load the <code>bain</code> package which includes the simulated <code>sesamesim</code> data set:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="hands-on-examples-using-bain.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bain)</span></code></pre></div>
<div id="using-bain-with-a-t_test-object" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Using <code>bain</code> with a <code>t_test</code> object</h2>
<p>If a <code>t_test</code> object is used, the main output table is
labeled: <em>“Bayesian informative hypothesis testing for an objectof class t_test”</em> (which denotes that a <code>t-test</code> was executed).</p>
<p><strong>Options:</strong></p>
<ol style="list-style-type: lower-alpha">
<li>Bayesian Student’s t-test (equal within group variances)</li>
<li>Bayesian Welch’s t-test (unequal within group variances</li>
<li>Bayesian paired samples t-test</li>
<li>Bayesian one group t-test</li>
<li>Bayesian Equivalence test</li>
</ol>
<p><strong>Main steps:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Execute the analysis with <code>t_test()</code>. Note that, <code>t_test</code> will apply list-wise deletion if there are cases with missing values in the variables used.</p></li>
<li><p>Call `bain:</p></li>
</ol>
<ul>
<li><p><code>set.seed(seed)</code>. Set <code>seed</code> equal to an integer number to create a repeatable random number sequence. <code>bain</code> uses sampling to compute Bayes factors and posterior model probabilities. It is therefore recommended to run analyses with two different seeds to ensure stability of the results.</p></li>
<li><p>When <code>t_test()</code> is used, hypotheses have to be specified using the names <code>x</code>, <code>y</code>, or <code>difference</code>.</p></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><p><code>results &lt;- bain(x,hypotheses,fraction = 1)</code>
<code>fraction = 1</code>represents the fraction of information in the data used to construct the prior distribution (see, for example, <span class="citation"><a href="references.html#ref-gu2018approximated" role="doc-biblioref">Gu, Mulder, &amp; Hoijtink</a> (<a href="references.html#ref-gu2018approximated" role="doc-biblioref">2018</a>)</span>). The default value 1 denotes the minimal fraction, 2 denotes twice the minimal fraction, etc.</p></li>
<li><p><code>print(results)</code> Print the results of an analysis with
<code>bain</code>.</p></li>
<li><p><code>summary(results, ci=0.95)</code> Present estimates and credibility intervals for the parameters used to specify the <code>hypotheses</code>. <code>ci</code> can be used to specify the confidence level of the credibility intervals.</p></li>
</ol>
<div id="students-t-test-equal-within-group-variances" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Student’s t-test (equal within group variances):</h3>
<ol style="list-style-type: decimal">
<li>Execute the analysis with <code>t_test()</code>:</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="hands-on-examples-using-bain.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># collect the data for the boys in the vector x and for the girls in the</span></span>
<span id="cb14-2"><a href="hands-on-examples-using-bain.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># vector y</span></span>
<span id="cb14-3"><a href="hands-on-examples-using-bain.html#cb14-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>sesamesim<span class="sc">$</span>postnumb[<span class="fu">which</span>(sesamesim<span class="sc">$</span>sex<span class="sc">==</span><span class="dv">1</span>)]</span>
<span id="cb14-4"><a href="hands-on-examples-using-bain.html#cb14-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>sesamesim<span class="sc">$</span>postnumb[<span class="fu">which</span>(sesamesim<span class="sc">$</span>sex<span class="sc">==</span><span class="dv">2</span>)]</span>
<span id="cb14-5"><a href="hands-on-examples-using-bain.html#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># execute student&#39;s t-test (with assumed equal variances)</span></span>
<span id="cb14-6"><a href="hands-on-examples-using-bain.html#cb14-6" aria-hidden="true" tabindex="-1"></a>ttest <span class="ot">&lt;-</span> <span class="fu">t_test</span>(x,y,<span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Call <code>bain</code> &amp; 3) Store the output in a <code>results</code> object:</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="hands-on-examples-using-bain.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a seed value</span></span>
<span id="cb15-2"><a href="hands-on-examples-using-bain.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb15-3"><a href="hands-on-examples-using-bain.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># test hypotheses with bain. The names of the means are x and y.</span></span>
<span id="cb15-4"><a href="hands-on-examples-using-bain.html#cb15-4" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">bain</span>(ttest, <span class="st">&quot;x = y; x &gt; y; x &lt; y&quot;</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Print the results:</li>
</ol>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="hands-on-examples-using-bain.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class t_test:
## 
##    Fit   Com   BF.u   BF.c   PMPa  PMPb 
## H1 0.183 0.016 11.583 11.583 0.853 0.794
## H2 0.777 0.500 1.554  3.481  0.114 0.107
## H3 0.223 0.500 0.446  0.287  0.033 0.031
## Hu                                 0.069
## 
## Hypotheses:
##   H1: x=y
##   H2: x&gt;y
##   H3: x&lt;y
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="hands-on-examples-using-bain.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results)</span></code></pre></div>
<pre><code>##   Parameter   n Estimate       lb       ub
## 1         x 115 30.09565 27.79295 32.39836
## 2         y 125 28.85600 26.64732 31.06468</code></pre>
</div>
<div id="welchs-t-test-unequal-within-group-variances" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Welch’s t-test (unequal within group variances):</h3>
<ol style="list-style-type: decimal">
<li>Execute the analysis with <code>t_test()</code>:</li>
</ol>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="hands-on-examples-using-bain.html#cb20-1" aria-hidden="true" tabindex="-1"></a>wtest <span class="ot">&lt;-</span> <span class="fu">t_test</span>(x,y,<span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>) <span class="co">#without assumed eq. variances</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Call <code>bain</code> &amp; 3) Store the output in a <code>results</code> object:</li>
</ol>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="hands-on-examples-using-bain.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a seed value</span></span>
<span id="cb21-2"><a href="hands-on-examples-using-bain.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb21-3"><a href="hands-on-examples-using-bain.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># test hypotheses with bain. The names of the means are x and y.</span></span>
<span id="cb21-4"><a href="hands-on-examples-using-bain.html#cb21-4" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">bain</span>(wtest, <span class="st">&quot;x = y; x &gt; y; x &lt; y&quot;</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Print the results:</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="hands-on-examples-using-bain.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class t_test:
## 
##    Fit   Com   BF.u   BF.c   PMPa  PMPb 
## H1 0.183 0.016 11.586 11.586 0.853 0.794
## H2 0.776 0.500 1.552  3.467  0.114 0.106
## H3 0.224 0.500 0.448  0.288  0.033 0.031
## Hu                                 0.069
## 
## Hypotheses:
##   H1: x=y
##   H2: x&gt;y
##   H3: x&lt;y
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="hands-on-examples-using-bain.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results)</span></code></pre></div>
<pre><code>##   Parameter   n Estimate       lb       ub
## 1         x 115 30.09565 27.70909 32.48221
## 2         y 125 28.85600 26.72394 30.98806</code></pre>
</div>
<div id="paired-samples-t-test" class="section level3" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Paired samples t-test:</h3>
<ol style="list-style-type: decimal">
<li>Execute the analysis with <code>t_test()</code>:</li>
</ol>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="hands-on-examples-using-bain.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the pre with the post measurements</span></span>
<span id="cb26-2"><a href="hands-on-examples-using-bain.html#cb26-2" aria-hidden="true" tabindex="-1"></a>pttest <span class="ot">&lt;-</span> <span class="fu">t_test</span>(sesamesim<span class="sc">$</span>prenumb,sesamesim<span class="sc">$</span>postnumb,<span class="at">paired =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Call <code>bain</code> &amp; 3) Store the output in a <code>results</code> object:</li>
</ol>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="hands-on-examples-using-bain.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a seed value</span></span>
<span id="cb27-2"><a href="hands-on-examples-using-bain.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb27-3"><a href="hands-on-examples-using-bain.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># test hypotheses with bain. The names of the means are x and y.</span></span>
<span id="cb27-4"><a href="hands-on-examples-using-bain.html#cb27-4" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">bain</span>(pttest, <span class="st">&quot;difference=0; difference&gt;0; difference&lt;0&quot;</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Print the results:</li>
</ol>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="hands-on-examples-using-bain.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class t_test:
## 
##    Fit   Com   BF.u  BF.c               PMPa  PMPb 
## H1 0.000 0.042 0.000 0.000              0.000 0.000
## H2 0.000 0.500 0.000 0.000              0.000 0.000
## H3 1.000 0.500 2.000 22919082073133.293 1.000 0.667
## Hu                                            0.333
## 
## Hypotheses:
##   H1: difference=0
##   H2: difference&gt;0
##   H3: difference&lt;0
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="hands-on-examples-using-bain.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results)</span></code></pre></div>
<pre><code>##    Parameter   n  Estimate        lb        ub
## 1 difference 240 -8.691667 -9.895994 -7.487339</code></pre>
</div>
<div id="one-group-t-test" class="section level3" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> One group t-test</h3>
<ol style="list-style-type: decimal">
<li>Execute the analysis with <code>t_test()</code>:</li>
</ol>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="hands-on-examples-using-bain.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare post measurements with the reference value 30</span></span>
<span id="cb32-2"><a href="hands-on-examples-using-bain.html#cb32-2" aria-hidden="true" tabindex="-1"></a>ttest_one_gr <span class="ot">&lt;-</span> <span class="fu">t_test</span>(sesamesim<span class="sc">$</span>postnumb)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Call <code>bain</code> &amp; 3) Store the output in a <code>results</code> object:</li>
</ol>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="hands-on-examples-using-bain.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a seed value</span></span>
<span id="cb33-2"><a href="hands-on-examples-using-bain.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb33-3"><a href="hands-on-examples-using-bain.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># test hypotheses with bain versus the reference value 30. Use x to refer to the mean</span></span>
<span id="cb33-4"><a href="hands-on-examples-using-bain.html#cb33-4" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">bain</span>(ttest_one_gr, <span class="st">&quot;x=30; x&gt;30; x&lt;30&quot;</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Print the results:</li>
</ol>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="hands-on-examples-using-bain.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class t_test:
## 
##    Fit   Com   BF.u   BF.c   PMPa  PMPb 
## H1 0.390 0.032 12.320 12.320 0.860 0.804
## H2 0.249 0.500 0.498  0.332  0.035 0.033
## H3 0.751 0.500 1.502  3.012  0.105 0.098
## Hu                                 0.065
## 
## Hypotheses:
##   H1: x=30
##   H2: x&gt;30
##   H3: x&lt;30
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="hands-on-examples-using-bain.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results)</span></code></pre></div>
<pre><code>##   Parameter   n Estimate       lb       ub
## 1         x 240    29.45 27.85743 31.04257</code></pre>
</div>
<div id="equivalence-test" class="section level3" number="3.1.5">
<h3><span class="header-section-number">3.1.5</span> Equivalence test</h3>
<ol style="list-style-type: decimal">
<li>Execute the analysis with <code>t_test()</code>:</li>
</ol>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="hands-on-examples-using-bain.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># collect the data for the boys in the vector x and for the girs in the</span></span>
<span id="cb38-2"><a href="hands-on-examples-using-bain.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># vector y</span></span>
<span id="cb38-3"><a href="hands-on-examples-using-bain.html#cb38-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>sesamesim<span class="sc">$</span>postnumb[<span class="fu">which</span>(sesamesim<span class="sc">$</span>sex<span class="sc">==</span><span class="dv">1</span>)]</span>
<span id="cb38-4"><a href="hands-on-examples-using-bain.html#cb38-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>sesamesim<span class="sc">$</span>postnumb[<span class="fu">which</span>(sesamesim<span class="sc">$</span>sex<span class="sc">==</span><span class="dv">2</span>)]</span>
<span id="cb38-5"><a href="hands-on-examples-using-bain.html#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># execute student&#39;s t-test</span></span>
<span id="cb38-6"><a href="hands-on-examples-using-bain.html#cb38-6" aria-hidden="true" tabindex="-1"></a>ttest_eq <span class="ot">&lt;-</span> <span class="fu">t_test</span>(x,y,<span class="at">paired =</span> <span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Compute the pooled within standard deviation using the variance of x:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="hands-on-examples-using-bain.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (ttest$v[1]) and y (ttest$v[2])</span></span>
<span id="cb39-2"><a href="hands-on-examples-using-bain.html#cb39-2" aria-hidden="true" tabindex="-1"></a>pwsd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(((<span class="fu">length</span>(x) <span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> ttest<span class="sc">$</span>v[<span class="dv">1</span>] <span class="sc">+</span> (<span class="fu">length</span>(y)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> ttest<span class="sc">$</span>v[<span class="dv">2</span>])<span class="sc">/</span></span>
<span id="cb39-3"><a href="hands-on-examples-using-bain.html#cb39-3" aria-hidden="true" tabindex="-1"></a>((<span class="fu">length</span>(x) <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span> (<span class="fu">length</span>(y) <span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb39-4"><a href="hands-on-examples-using-bain.html#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print pwsd in order to be able to include it in the hypothesis. Its value</span></span>
<span id="cb39-5"><a href="hands-on-examples-using-bain.html#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pwsd)</span></code></pre></div>
<pre><code>## [1] 12.59908</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><p>Call <code>bain</code> &amp;</p></li>
<li><p>Store the output in a <code>results</code> object.
Test hypotheses (the means of boy and girl differ less than .2 * pwsd =
2.52 VERSUS the means differ more than .2 * pwsd = 2.52).
Note that, with <code>bain</code>, .2 is a value for <a href="https://en.wikiversity.org/wiki/Cohen%27s_d#:~:text=Cohen&#39;s%20d%20is%20an%20effect,the%20comparison%20between%20two%20means.">Cohen’s d</a> reflecting a <em>“small”</em> effect, that
is, the means differ less or more than .2 pwsd. Again, use x and y to refer to the means:</p></li>
</ol>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="hands-on-examples-using-bain.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a seed value</span></span>
<span id="cb41-2"><a href="hands-on-examples-using-bain.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb41-3"><a href="hands-on-examples-using-bain.html#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="hands-on-examples-using-bain.html#cb41-4" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">bain</span>(ttest_eq, <span class="st">&quot;x - y &gt; -2.52 &amp; x - y &lt; 2.52&quot;</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Print the results:</li>
</ol>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="hands-on-examples-using-bain.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class t_test:
## 
##    Fit   Com   BF.u  BF.c   PMPa  PMPb 
## H1 0.770 0.111 6.967 26.927 1.000 0.874
## Hu                                0.126
## 
## Hypotheses:
##   H1: x-y&gt;-2.52&amp;x-y&lt;2.52
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="hands-on-examples-using-bain.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results)</span></code></pre></div>
<pre><code>##   Parameter   n Estimate       lb       ub
## 1         x 115 30.09565 27.79295 32.39836
## 2         y 125 28.85600 26.64732 31.06468</code></pre>
</div>
</div>
<div id="using-bain-with-a-lm-object" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Using <code>bain</code> with a <code>lm</code> object</h2>
<p><strong>Options:</strong></p>
<ol style="list-style-type: lower-alpha">
<li><p>Bayesian ANOVA. The example concerns a one-way ANOVA. Two-way or higher
order ANOVAs can only be handled by recoding all factors into one
factor. If, for example, there is a factor <code>sex</code> with levels <code>man</code> and <code>woman</code>,
and a factor <code>age</code> with levels <code>young</code> and <code>old</code>, these have to be recoded in a
new factor <code>sexage</code> with levels <code>manyoung</code>, <code>manold</code>, <code>womanyoung</code>, <code>womanold</code>.
If a <code>lm</code> “ANOVA” object is used, the main output table is
labeled: “Bayesian informative hypothesis testing for an object
of class lm (ANOVA)”</p></li>
<li><p>Bayesian ANCOVA. The example concerns a one-way ANCOVA. Two-way or higher
order ANCOVAs can only be handled by recoding all factors into one
factor. <strong>Note that calls to <code>lm</code> using functions of the predictors
(for example, adding squared predictors to the model using commands like
<code>y ~ x + I(x^2)</code>)
can not be processed by <code>bain</code>.</strong> However, one can compute a new variable
(for example, a squared predictor) and add this variable to the
model specification of <code>lm</code>. If a <code>lm</code> “ANCOVA” object is used, the
main output table is
labeled: “Bayesian informative hypothesis testing for an object
of class lm (ANCOVA).” <strong>Note that, in
the ANCOVA the covariates are centered!</strong></p></li>
<li><p>Bayesian multiple regression. <strong>Note that calls to <code>lm</code> using
functions of the predictors (for example, adding squared predictors
to the model using commands like <code>y ~ x + I(x^2)</code>)
can not be processed by <code>bain</code>.</strong> However, one can compute a new variable
(for example, a squared predictor) and add this variable to the
model specification of <code>lm</code>. Note furthermore, that only if
<code>standardize = FALSE</code> interactions between predictors should
be processed, because a standardized interaction is not the same as the
interaction between two standardized variables.
If a <code>lm</code> “regression with only continuous predictors”
object is used, the main output table is
labeled: “Bayesian informative hypothesis testing for an object
of class lm (continuous predictors).” If a <code>lm</code> object contains
<strong>two or more</strong>factors and, optionally, continuous predictors, the main output table islabeled: “Bayesian informative hypothesis testing for an object of
class lm (mixed predictors).” In case of mixed predictors, the one group
approach to computing Bayes factors is used (see, <span class="citation"><a href="references.html#ref-hoijtink2019bayesian" role="doc-biblioref">Hoijtink, Gu, &amp; Mulder</a> (<a href="references.html#ref-hoijtink2019bayesian" role="doc-biblioref">2019</a>)</span>). This may render inferior results if group sizes are unequal.</p></li>
<li><p>Bayesian ANOVA. Sensitivity analysis. See <span class="citation"><a href="references.html#ref-hoijtink2019tutorial" role="doc-biblioref">Hoijtink, Mulder, Lissa, &amp; Gu</a> (<a href="references.html#ref-hoijtink2019tutorial" role="doc-biblioref">2019</a>)</span> for elaborations.</p></li>
</ol>
<p><strong>Main steps:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Execute the analysis with <code>lm()</code>. Note that, <code>lm</code> will apply list-wise deletion if there are cases with missing values in the variables used.</p></li>
<li><p>Display the estimates and their names using the command <code>coef(x)</code>. (Unique abbreviations of) these names will be used to specify <code>hypotheses</code>.</p></li>
<li><p><code>set.seed(seed)</code>. Set <code>seed</code> equal to an integer
number to create a repeatable random number sequence. <code>bain</code> uses sampling to compute Bayes factors and posterior model probabilities. It is therefore recommended to run analyses with two different seeds to ensure stability of the results.
And call <code>bain</code> by using <code>results &lt;- bain(x,hypotheses,fraction = 1)</code> or
<code>results &lt;-bain(x,hypotheses,fraction = 1,standardize = FALSE)</code>. The first call to
<code>bain</code> is used in case of <code>lm</code> implementations of <em>ANOVA</em> and <em>ANCOVA</em>. The
second call to <code>bain</code> is used in case of <code>lm</code> implementations of
<em>multiple regression</em>. With <code>standardize = TRUE</code> hypotheses with respect
to standardized regression coefficients are evaluated. With <code>standardize = FALSE</code> hypotheses with respect to unstandardized regression coefficients
are evaluated. <code>fraction = 1</code> represents the fraction of information in the data used to construct the prior distribution. The default value 1 denotes the minimal fraction, 2 denotes twice the minimal fraction, etc.</p></li>
<li><p><code>print(results)</code> Print the results of an analysis with
<code>bain</code>.</p></li>
<li><p><code>summary(results, ci=0.95)</code> Present estimates and credibility intervals for the parameters used to specify the <code>hypotheses</code>. <code>ci</code> can be used to specify the confidence level of the credibility intervals.</p></li>
</ol>
<div id="anova" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> ANOVA</h3>
<ol style="list-style-type: decimal">
<li>Execute the analysis with <code>lm()</code>:</li>
</ol>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="hands-on-examples-using-bain.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a factor of variable site</span></span>
<span id="cb46-2"><a href="hands-on-examples-using-bain.html#cb46-2" aria-hidden="true" tabindex="-1"></a>sesamesim<span class="sc">$</span>site <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sesamesim<span class="sc">$</span>site)</span>
<span id="cb46-3"><a href="hands-on-examples-using-bain.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># execute an analysis of variance using lm() which, due to the -1, returns</span></span>
<span id="cb46-4"><a href="hands-on-examples-using-bain.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># estimates of the means per group</span></span>
<span id="cb46-5"><a href="hands-on-examples-using-bain.html#cb46-5" aria-hidden="true" tabindex="-1"></a>anov <span class="ot">&lt;-</span> <span class="fu">lm</span>(postnumb<span class="sc">~</span>site<span class="dv">-1</span>,sesamesim)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Display the estimated coefficients using <code>coef()</code>:</li>
</ol>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="hands-on-examples-using-bain.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(anov)</span></code></pre></div>
<pre><code>##    site1    site2    site3    site4    site5 
## 29.66667 38.98182 23.18750 25.32558 31.72222</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Set seed and call <code>bain</code>:</li>
</ol>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="hands-on-examples-using-bain.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb49-2"><a href="hands-on-examples-using-bain.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># test hypotheses with bain</span></span>
<span id="cb49-3"><a href="hands-on-examples-using-bain.html#cb49-3" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">bain</span>(anov, <span class="st">&quot;site1=site2=site3=site4=site5; site2&gt;site5&gt;site1&gt;</span></span>
<span id="cb49-4"><a href="hands-on-examples-using-bain.html#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="st">site3&gt;site4&quot;</span>)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Print the results:</li>
</ol>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="hands-on-examples-using-bain.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class lm (ANOVA):
## 
##    Fit   Com   BF.u   BF.c   PMPa  PMPb 
## H1 0.000 0.000 0.000  0.000  0.000 0.000
## H2 0.121 0.008 14.559 16.428 1.000 0.936
## Hu                                 0.064
## 
## Hypotheses:
##   H1: site1=site2=site3=site4=site5
##   H2: site2&gt;site5&gt;site1&gt;site3&gt;site4
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="hands-on-examples-using-bain.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results)</span></code></pre></div>
<pre><code>##   Parameter  n Estimate       lb       ub
## 1     site1 60 29.66667 26.82991 32.50343
## 2     site2 55 38.98182 36.01892 41.94472
## 3     site3 64 23.18750 20.44082 25.93418
## 4     site4 43 25.32558 21.97466 28.67650
## 5     site5 18 31.72222 26.54303 36.90141</code></pre>
</div>
<div id="ancova" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> ANCOVA</h3>
<ol style="list-style-type: decimal">
<li>Execute the analysis with <code>lm()</code>:</li>
</ol>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="hands-on-examples-using-bain.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Center the covariate. If centered the coef() command below displays the</span></span>
<span id="cb54-2"><a href="hands-on-examples-using-bain.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># adjusted means. If not centered the intercepts are displayed.</span></span>
<span id="cb54-3"><a href="hands-on-examples-using-bain.html#cb54-3" aria-hidden="true" tabindex="-1"></a>sesamesim<span class="sc">$</span>prenumb <span class="ot">&lt;-</span> sesamesim<span class="sc">$</span>prenumb <span class="sc">-</span> <span class="fu">mean</span>(sesamesim<span class="sc">$</span>prenumb)</span>
<span id="cb54-4"><a href="hands-on-examples-using-bain.html#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># execute an analysis of covariance using lm() which, due to the -1, returns</span></span>
<span id="cb54-5"><a href="hands-on-examples-using-bain.html#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co"># estimates of the adjusted means per group</span></span>
<span id="cb54-6"><a href="hands-on-examples-using-bain.html#cb54-6" aria-hidden="true" tabindex="-1"></a>ancov <span class="ot">&lt;-</span> <span class="fu">lm</span>(postnumb<span class="sc">~</span>site<span class="sc">+</span>prenumb<span class="dv">-1</span>,sesamesim)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Display the estimated coefficients using <code>coef()</code>:</li>
</ol>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="hands-on-examples-using-bain.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(ancov)</span></code></pre></div>
<pre><code>##      site1      site2      site3      site4      site5    prenumb 
## 27.4293820 34.9818244 27.6904082 26.9840163 31.4298837  0.7159311</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Set seed and call <code>bain</code>:</li>
</ol>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="hands-on-examples-using-bain.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb57-2"><a href="hands-on-examples-using-bain.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># test hypotheses with bain</span></span>
<span id="cb57-3"><a href="hands-on-examples-using-bain.html#cb57-3" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">bain</span>(ancov, <span class="st">&quot;site1=site2=site3=site4=site5;</span></span>
<span id="cb57-4"><a href="hands-on-examples-using-bain.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="st">                        site2&gt;site5&gt;site1&gt;site3&gt;site4&quot;</span>)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Print the results:</li>
</ol>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="hands-on-examples-using-bain.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class lm (ANCOVA):
## 
##    Fit   Com   BF.u   BF.c   PMPa  PMPb 
## H1 0.000 0.000 0.002  0.002  0.000 0.000
## H2 0.183 0.009 19.899 24.126 1.000 0.952
## Hu                                 0.048
## 
## Hypotheses:
##   H1: site1=site2=site3=site4=site5
##   H2: site2&gt;site5&gt;site1&gt;site3&gt;site4
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="hands-on-examples-using-bain.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results)</span></code></pre></div>
<pre><code>##   Parameter   n   Estimate         lb        ub
## 1     site1  60 27.4293820 25.1603844 29.698380
## 2     site2  55 34.9818244 32.5529993 37.410650
## 3     site3  64 27.6904082 25.4002689 29.980548
## 4     site4  43 26.9840163 24.3250440 29.642989
## 5     site5  18 31.4298837 27.3413936 35.518374
## 6   prenumb 240  0.7159311  0.5986552  0.833207</code></pre>
</div>
<div id="multiple-regression" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Multiple regression</h3>
<ol style="list-style-type: decimal">
<li>Execute the analysis with <code>lm()</code>:</li>
</ol>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="hands-on-examples-using-bain.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># execute a multiple regression using lm()</span></span>
<span id="cb62-2"><a href="hands-on-examples-using-bain.html#cb62-2" aria-hidden="true" tabindex="-1"></a>regr <span class="ot">&lt;-</span> <span class="fu">lm</span>(postnumb <span class="sc">~</span> age <span class="sc">+</span> peabody <span class="sc">+</span> prenumb,sesamesim)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Display the estimated coefficients using <code>coef()</code>:</li>
</ol>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="hands-on-examples-using-bain.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(regr)</span></code></pre></div>
<pre><code>## (Intercept)         age     peabody     prenumb 
##  18.1160056   0.1159941   0.1157549   0.6727219</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Set seed and call <code>bain</code>:</li>
</ol>
<ul>
<li><strong>Testing unstandardized coefficients.</strong></li>
</ul>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="hands-on-examples-using-bain.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb65-2"><a href="hands-on-examples-using-bain.html#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co">#test hypotheses with bain. Note that standardize = FALSE denotes that the</span></span>
<span id="cb65-3"><a href="hands-on-examples-using-bain.html#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co"># hypotheses are in terms of unstandardized regression coefficients</span></span>
<span id="cb65-4"><a href="hands-on-examples-using-bain.html#cb65-4" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">bain</span>(regr, <span class="st">&quot;age = 0 &amp; peab=0 &amp; pre=0 ; age &gt; 0 &amp; peab &gt; 0 &amp; pre &gt; 0&quot;</span>,</span>
<span id="cb65-5"><a href="hands-on-examples-using-bain.html#cb65-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">standardize =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<ul>
<li><strong>Testing standardized coefficients:</strong> Since it is only meaningful to compare regression coefficients if they are measured on the same scale, <code>bain</code> can also evaluate standardized regression coefficients (based on the <code>seBeta</code> function by <span class="citation"><a href="references.html#ref-jones2015normal" role="doc-biblioref">Jones &amp; Waller</a> (<a href="references.html#ref-jones2015normal" role="doc-biblioref">2015</a>)</span>):</li>
</ul>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="hands-on-examples-using-bain.html#cb66-1" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">bain</span>(regr, <span class="st">&quot;age = peab = pre ; pre &gt; age &gt; peab&quot;</span>,<span class="at">standardize =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Print the (standardized) results:</li>
</ol>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="hands-on-examples-using-bain.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class lm (continuous predictors):
## 
##    Fit   Com   BF.u  BF.c  PMPa  PMPb 
## H1 0.000 0.202 0.000 0.000 0.000 0.000
## H2 0.125 0.216 0.579 0.519 1.000 0.367
## Hu                               0.633
## 
## Hypotheses:
##   H1: age=peabody=prenumb
##   H2: prenumb&gt;age&gt;peabody
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="hands-on-examples-using-bain.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results)</span></code></pre></div>
<pre><code>##   Parameter   n   Estimate          lb        ub
## 1       age 240 0.05797594 -0.04043979 0.1563917
## 2   peabody 240 0.14781779  0.03457188 0.2610637
## 3   prenumb 240 0.56740695  0.46067277 0.6741411</code></pre>
</div>
</div>
<div id="lavaan" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Using <code>bain</code> with a <code>lavaan</code> object</h2>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="hands-on-examples-using-bain.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(lavaan))</span></code></pre></div>
<p>If a <code>lavaan</code> object is used, the main output table is labeled:
<em>“Bayesian informative hypothesis testing for an object
of class lavaan”</em>. See the tutorial by <span class="citation"><a href="references.html#ref-van2021teacher" role="doc-biblioref">Van Lissa et al.</a> (<a href="references.html#ref-van2021teacher" role="doc-biblioref">2021</a>)</span> for further elaborations.
Also, visit <a href="www.lavaan.org">this link</a> for more <code>lavaan</code> mini tutorials, examples and elaborations.</p>
<p><strong>Options:</strong></p>
<ol style="list-style-type: lower-alpha">
<li><p>Bayesian confirmatory factor analysis</p></li>
<li><p>Bayesian latent regression</p></li>
<li><p>Bayesian multiple group latent regression. Note that, multiple group
models with between group restrictions cannot be processed.</p></li>
</ol>
<p><strong>Main steps:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Specify a <code>lavaan</code> model using the <code>model &lt;- ...</code> command. In case
of multiple group models, only models <strong>without</strong> between group
restrictions can be processed by <code>bain</code> with a <code>lavaan</code> object
as input. Secondly, execute an analysis with the sem, cfa, or growth functions (e.g: <code>x &lt;- sem()</code> or <code>x &lt;- cfa()</code> or <code>x &lt;- growth()</code>) implemented in <a href="https://lavaan.ugent.be"><code>lavaan</code></a>.
Note that, by default, <code>lavaan</code> will apply list-wise deletion if there are cases with missing values in the variables used. An imputation based method
for dealing with missing values tailored to Bayesian hypothesis
evaluation is illustrated in section <a href="hands-on-examples-using-bain.html#named">3.4</a>. (based on <span class="citation"><a href="references.html#ref-hoijtink2019computing" role="doc-biblioref">Hoijtink, Gu, Mulder, &amp; Rosseel</a> (<a href="references.html#ref-hoijtink2019computing" role="doc-biblioref">2019</a>)</span>). If an analysis with <code>lavaan</code> is executed using <code>missing = "fiml"</code> the sample size is not corrected for the presence of missing values. This will affect (bias) the evaluation of hypotheses specified using (about) equality constraints.<br />
Specify a <code>lavaan</code> model using the <code>model &lt;- ...</code> command. In case
of multiple group models, only models <strong>without</strong> between group
restrictions can be processed by <code>bain</code> with a <code>lavaan</code> object
as input.</p></li>
<li><p>Display the estimates and their names using the command <code>coef(x)</code>.
Only parameters who’s names contain <code>~</code> (regression coefficients),
<code>~1</code> (intercepts), or <code>=~</code> (factor loadings) can be used in the
specification of hypotheses. (Unique abbreviations of) the names
can be used to specify <code>hypotheses</code>. For multiple group analyses
the names have to end with a group label <code>.grp</code>. Group labels
can be assigned using commands like
<code>sesamesim$sex &lt;- factor(sesamesim$sex, labels = c("boy", "girl"))</code>.
If in a <code>lavaan</code> model parameters are labeled, e.g., as in
<code>model &lt;- 'age ~ c(a1, a2)*peabody + c(b1, b2)*1</code> then the labels
have to be used in the specification of hypotheses.</p></li>
<li><p><code>set.seed(seed)</code>. Set <code>seed</code> equal to an integer
number to create a repeatable random number sequence. <code>bain</code> uses sampling to compute Bayes factors and posterior model probabilities. It is therefore recommended to run analyses with two different seeds to ensure stability of the results.
And <code>results &lt;- bain(x,hypotheses,fraction = 1,standardize = FALSE)</code>.
With <code>standardize = TRUE</code> hypotheses with respect
to standardized coefficients are evaluated. With <code>standardize = FALSE</code> hypotheses with respect to unstandardized coefficients
are evaluated. <code>fraction = 1</code> represents the fraction of information in the data used to construct the prior distribution. The default value 1 denotes the minimal fraction, 2 denotes twice the minimal fraction, etc.).</p></li>
<li><p><code>print(results)</code> Print the results of an analysis with
<code>bain</code>.</p></li>
<li><p><code>summary(results, ci=0.95)</code> Present estimates and credibility intervals for the parameters used to specify the <code>hypotheses</code>. <code>ci</code> can be used to specify the confidence level of the credibility intervals.</p></li>
</ol>
<div id="confirmatory-factor-analysis-cfa" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Confirmatory Factor Analysis (CFA):</h3>
<ol style="list-style-type: decimal">
<li>Speficy the model and execute the analysis:</li>
</ol>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="hands-on-examples-using-bain.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Specify and fit the confirmatory factor model</span></span>
<span id="cb72-2"><a href="hands-on-examples-using-bain.html#cb72-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb72-3"><a href="hands-on-examples-using-bain.html#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="st">    A =~ Ab + Al + Af + An + Ar + Ac </span></span>
<span id="cb72-4"><a href="hands-on-examples-using-bain.html#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="st">    B =~ Bb + Bl + Bf + Bn + Br + Bc </span></span>
<span id="cb72-5"><a href="hands-on-examples-using-bain.html#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb72-6"><a href="hands-on-examples-using-bain.html#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the lavaan sem function to execute the confirmatory factor analysis</span></span>
<span id="cb72-7"><a href="hands-on-examples-using-bain.html#cb72-7" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">sem</span>(model1, <span class="at">data =</span> sesamesim, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Display the estimates and specify an object containing the hypotheses:</li>
</ol>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="hands-on-examples-using-bain.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit1)</span></code></pre></div>
<pre><code>##  A=~Ab  A=~Al  A=~Af  A=~An  A=~Ar  A=~Ac  B=~Bb  B=~Bl  B=~Bf  B=~Bn  B=~Br 
##  3.885  9.583  3.367 10.906  1.790  4.424  4.433  5.054  3.200  8.588  1.997 
##  B=~Bc Ab~~Ab Al~~Al Af~~Af An~~An Ar~~Ar Ac~~Ac Bb~~Bb Bl~~Bl Bf~~Bf Bn~~Bn 
##  3.685 14.808 47.655  4.843 25.920  3.370  6.101 13.857 35.349  5.360 19.799 
## Br~~Br Bc~~Bc   A~~B 
##  3.693  6.219  0.788</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="hands-on-examples-using-bain.html#cb75-1" aria-hidden="true" tabindex="-1"></a>hypotheses1 <span class="ot">&lt;-</span></span>
<span id="cb75-2"><a href="hands-on-examples-using-bain.html#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="st">&quot; A=~Ab &gt; .6 &amp; A=~Al &gt; .6 &amp; A=~Af &gt; .6 &amp; A=~An &gt; .6 &amp; A=~Ar &gt; .6 &amp; A=~Ac &gt;.6 &amp; </span></span>
<span id="cb75-3"><a href="hands-on-examples-using-bain.html#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="st">B=~Bb &gt; .6 &amp; B=~Bl &gt; .6 &amp; B=~Bf &gt; .6 &amp; B=~Bn &gt; .6 &amp; B=~Br &gt; .6 &amp; B=~Bc &gt;.6&quot;</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Set seed and call <code>bain</code>:</li>
</ol>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="hands-on-examples-using-bain.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb76-2"><a href="hands-on-examples-using-bain.html#cb76-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">bain</span>(fit1,hypotheses1,<span class="at">fraction=</span><span class="dv">1</span>,<span class="at">standardize=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Print the results:</li>
</ol>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="hands-on-examples-using-bain.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(y)</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class lavaan:
## 
##    Fit   Com   BF.u   BF.c    PMPa  PMPb 
## H1 0.880 0.009 95.519 788.316 1.000 0.990
## Hu                                  0.010
## 
## Hypotheses:
##   H1: A=~Ab&gt;.6&amp;A=~Al&gt;.6&amp;A=~Af&gt;.6&amp;A=~An&gt;.6&amp;A=~Ar&gt;.6&amp;A=~Ac&gt;.6&amp;B=~Bb&gt;.6&amp;B=~Bl&gt;.6&amp;B=~Bf&gt;.6&amp;B=~Bn&gt;.6&amp;B=~Br&gt;.6&amp;B=~Bc&gt;.6
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="hands-on-examples-using-bain.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(y, <span class="at">ci =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##    Parameter   n  Estimate        lb        ub
## 1      A=~Ab 240 0.7104508 0.6433340 0.7775677
## 2      A=~Al 240 0.8114029 0.7632944 0.8595115
## 3      A=~Af 240 0.8370936 0.7941226 0.8800647
## 4      A=~An 240 0.9061333 0.8769727 0.9352938
## 5      A=~Ar 240 0.6980414 0.6287429 0.7673399
## 6      A=~Ac 240 0.8731170 0.8374249 0.9088091
## 7      B=~Bb 240 0.7658397 0.7076188 0.8240605
## 8      B=~Bl 240 0.6476698 0.5687998 0.7265397
## 9      B=~Bf 240 0.8101849 0.7604160 0.8599537
## 10     B=~Bn 240 0.8878987 0.8531156 0.9226818
## 11     B=~Br 240 0.7205677 0.6540778 0.7870576
## 12     B=~Bc 240 0.8282004 0.7819303 0.8744705</code></pre>
</div>
<div id="latent-regression" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Latent regression</h3>
<ol style="list-style-type: decimal">
<li>Speficy the model and execute the analysis:</li>
</ol>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="hands-on-examples-using-bain.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Specify and fit the confirmatory factor model</span></span>
<span id="cb81-2"><a href="hands-on-examples-using-bain.html#cb81-2" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb81-3"><a href="hands-on-examples-using-bain.html#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="st">    A  =~ Ab + Al + Af + An + Ar + Ac </span></span>
<span id="cb81-4"><a href="hands-on-examples-using-bain.html#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="st">    B =~ Bb + Bl + Bf + Bn + Br + Bc</span></span>
<span id="cb81-5"><a href="hands-on-examples-using-bain.html#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="hands-on-examples-using-bain.html#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="st">    A ~ B + age + peabody</span></span>
<span id="cb81-7"><a href="hands-on-examples-using-bain.html#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb81-8"><a href="hands-on-examples-using-bain.html#cb81-8" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">sem</span>(model2, <span class="at">data =</span> sesamesim, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Display the estimates and specify an object containing the hypotheses:</li>
</ol>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="hands-on-examples-using-bain.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit2)</span></code></pre></div>
<pre><code>##     A=~Ab     A=~Al     A=~Af     A=~An     A=~Ar     A=~Ac     B=~Bb     B=~Bl 
##     2.392     5.899     2.074     6.713     1.102     2.723     4.434     5.055 
##     B=~Bf     B=~Bn     B=~Br     B=~Bc       A~B     A~age A~peabody    Ab~~Ab 
##     3.200     8.587     1.997     3.686     1.284     0.000    -0.002    14.803 
##    Al~~Al    Af~~Af    An~~An    Ar~~Ar    Ac~~Ac    Bb~~Bb    Bl~~Bl    Bf~~Bf 
##    47.683     4.837    25.956     3.370     6.101    13.853    35.341     5.358 
##    Bn~~Bn    Br~~Br    Bc~~Bc 
##    19.815     3.695     6.216</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="hands-on-examples-using-bain.html#cb84-1" aria-hidden="true" tabindex="-1"></a>hypotheses2 <span class="ot">&lt;-</span> <span class="st">&quot;A~B &gt; A~peabody = A~age = 0; </span></span>
<span id="cb84-2"><a href="hands-on-examples-using-bain.html#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="st">               A~B &gt; A~peabody &gt; A~age = 0; </span></span>
<span id="cb84-3"><a href="hands-on-examples-using-bain.html#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="st">A~B &gt; A~peabody &gt; A~age &gt; 0&quot;</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Set seed and call <code>bain</code>:</li>
</ol>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="hands-on-examples-using-bain.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb85-2"><a href="hands-on-examples-using-bain.html#cb85-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">bain</span>(fit2, hypotheses2, <span class="at">fraction =</span> <span class="dv">1</span>, <span class="at">standardize =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Print the results:</li>
</ol>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="hands-on-examples-using-bain.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(y)</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class lavaan:
## 
##    Fit    Com   BF.u    BF.c    PMPa  PMPb 
## H1 69.899 0.463 150.871 150.871 0.792 0.788
## H2 3.045  0.090 33.858  33.858  0.178 0.177
## H3 0.069  0.012 5.850   6.210   0.031 0.031
## Hu                                    0.005
## 
## Hypotheses:
##   H1: A~B&gt;A~peabody=A~age=0
##   H2: A~B&gt;A~peabody&gt;A~age=0
##   H3: A~B&gt;A~peabody&gt;A~age&gt;0
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="hands-on-examples-using-bain.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(y, <span class="at">ci =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##    Parameter   n     Estimate          lb         ub
## 1      A=~Ab 240  0.711205262  0.64424171 0.77816881
## 2      A=~Al 240  0.811775528  0.76376372 0.85978734
## 3      A=~Af 240  0.837770094  0.79496009 0.88058010
## 4      A=~An 240  0.906287871  0.87719307 0.93538268
## 5      A=~Ar 240  0.698701975  0.62953799 0.76786596
## 6      A=~Ac 240  0.873484275  0.83789531 0.90907324
## 7      B=~Bb 240  0.765919628  0.70771871 0.82412054
## 8      B=~Bl 240  0.647765959  0.56891562 0.72661629
## 9      B=~Bf 240  0.810246503  0.76049539 0.85999762
## 10     B=~Bn 240  0.887803097  0.85301152 0.92259468
## 11     B=~Br 240  0.720382073  0.65386367 0.78690047
## 12     B=~Bc 240  0.828276665  0.78202772 0.87452561
## 13       A~B 240  0.788751775  0.72999714 0.84750641
## 14     A~age 240 -0.000478606 -0.09265311 0.09169589
## 15 A~peabody 240 -0.015527151 -0.10769273 0.07663843</code></pre>
</div>
<div id="multiple-group-regression" class="section level3" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Multiple group regression</h3>
<ol style="list-style-type: decimal">
<li>Speficy the model and execute the analysis:</li>
</ol>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="hands-on-examples-using-bain.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Specify and fit the confirmatory factor model</span></span>
<span id="cb90-2"><a href="hands-on-examples-using-bain.html#cb90-2" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb90-3"><a href="hands-on-examples-using-bain.html#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="st">    postnumb ~ prenumb + peabody </span></span>
<span id="cb90-4"><a href="hands-on-examples-using-bain.html#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb90-5"><a href="hands-on-examples-using-bain.html#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign labels to the groups to be used when formulating</span></span>
<span id="cb90-6"><a href="hands-on-examples-using-bain.html#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co"># hypotheses</span></span>
<span id="cb90-7"><a href="hands-on-examples-using-bain.html#cb90-7" aria-hidden="true" tabindex="-1"></a>sesamesim<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(sesamesim<span class="sc">$</span>sex, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;boy&quot;</span>, <span class="st">&quot;girl&quot;</span>))</span>
<span id="cb90-8"><a href="hands-on-examples-using-bain.html#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the multiple group regression model</span></span>
<span id="cb90-9"><a href="hands-on-examples-using-bain.html#cb90-9" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">sem</span>(model3, <span class="at">data =</span> sesamesim, <span class="at">std.lv =</span> <span class="cn">TRUE</span>, <span class="at">group =</span> <span class="st">&quot;sex&quot;</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Display the estimates and specify an object containing the hypotheses:</li>
</ol>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="hands-on-examples-using-bain.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit3)</span></code></pre></div>
<pre><code>##      postnumb~prenumb      postnumb~peabody    postnumb~~postnumb 
##                 0.660                 0.173                85.644 
##            postnumb~1   postnumb~prenumb.g2   postnumb~peabody.g2 
##                21.645                 0.723                 0.052 
## postnumb~~postnumb.g2         postnumb~1.g2 
##                80.068                26.715</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="hands-on-examples-using-bain.html#cb93-1" aria-hidden="true" tabindex="-1"></a>hypotheses3 <span class="ot">&lt;-</span></span>
<span id="cb93-2"><a href="hands-on-examples-using-bain.html#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;postnumb~prenumb.boy = postnumb~prenumb.girl &amp; postnumb~peabody.boy = postnumb~peabody.girl;</span></span>
<span id="cb93-3"><a href="hands-on-examples-using-bain.html#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="st"> postnumb~prenumb.boy &lt; postnumb~prenumb.girl &amp; postnumb~peabody.boy &lt; postnumb~peabody.girl</span></span>
<span id="cb93-4"><a href="hands-on-examples-using-bain.html#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Set seed and call <code>bain</code>:</li>
</ol>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="hands-on-examples-using-bain.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb94-2"><a href="hands-on-examples-using-bain.html#cb94-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">bain</span>(fit3, hypotheses3, <span class="at">fraction =</span> <span class="dv">1</span>, <span class="at">standardize =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Print the results:</li>
</ol>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="hands-on-examples-using-bain.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(y)</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class lavaan:
## 
##    Fit   Com   BF.u   BF.c   PMPa  PMPb 
## H1 7.786 0.189 41.199 41.199 0.996 0.972
## H2 0.019 0.106 0.181  0.165  0.004 0.004
## Hu                                 0.024
## 
## Hypotheses:
##   H1: postnumb~prenumb.boy=postnumb~prenumb.girl&amp;postnumb~peabody.boy=postnumb~peabody.girl
##   H2: postnumb~prenumb.boy&lt;postnumb~prenumb.girl&amp;postnumb~peabody.boy&lt;postnumb~peabody.girl
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="hands-on-examples-using-bain.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(y, <span class="at">ci =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##               Parameter   n   Estimate          lb        ub
## 1  postnumb~prenumb.boy 115 0.53181375  0.38134118 0.6822863
## 2  postnumb~peabody.boy 115 0.23097972  0.06511841 0.3968410
## 3        postnumb~1.boy 115 1.66487431  1.11918686 2.2105618
## 4 postnumb~prenumb.girl 125 0.63788102  0.51532021 0.7604418
## 5 postnumb~peabody.girl 125 0.06298202 -0.09071110 0.2166751
## 6       postnumb~1.girl 125 2.20546228  1.63305518 2.7778694</code></pre>
</div>
</div>
<div id="named" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Using <code>bain</code> with a named vector</h2>
<p>If a <code>named vector</code> object is used, the main output table is labeled:
“Bayesian informative hypothesis testing for an object
of class numeric” (which denotes that <code>named vector</code> input was used).</p>
<p><strong>Options:</strong></p>
<ol style="list-style-type: lower-alpha">
<li>Bayesian ANOVA</li>
<li>Bayesian Welch’s ANOVA (unequal within group variances)</li>
<li>Bayesian robust (against non-normality) ANOVA (unequal within group variances)</li>
<li>Bayesian ANCOVA</li>
<li>Bayesian repeated measures analysis (one within factor)</li>
<li>Bayesian repeated measures analysis (within between design)</li>
<li>Bayesian one group logistic regression (counterpart of multiple
regression)</li>
<li>Bayesian multiple group logistic regression (counterpart of ANCOVA)</li>
<li>Bayesian multiple regression with missing data</li>
<li>Bayesian confirmatory factor analysis
.
.(add multilevel models here maybe?)
.</li>
</ol>
<p><strong>Main steps:</strong></p>
<ol style="list-style-type: decimal">
<li>Execute a statistical analysis.</li>
</ol>
<p>In case of a single group analysis, the
following information has to be extracted from the statistical analysis and
supplied to <code>bain</code>:</p>
<ol style="list-style-type: lower-alpha">
<li>A vector containing estimates of the parameters
used to specify <code>hypotheses</code>;</li>
<li>A list containing the covariance matrix of these parameters; and,</li>
<li>The sample size used for estimation of the parameters. Note that,
due to missing values this sample size may be smaller than the total sample
size.</li>
</ol>
<p>In case of a multiple group
analysis, the following information has to be extracted from the statistical
analysis and supplied to <code>bain</code>:</p>
<ol style="list-style-type: lower-alpha">
<li>A vector containing estimates of the group specific
parameters possibly augmented with the
estimates of parameters that are shared by the groups. The structure
of this vector is
[parameters of group 1, parameters of group 2, …, the parameters that
are shared by the groups];</li>
<li>A list containing, per group, the covariance
matrix of the parameters corresponding to the group at hand and, possibly,
the augmented parameters. In the rows and columns of each covariance matrix
the parameters of the group at hand come first, possibly followed by the
augmented parameters.</li>
<li>Per group the sample size used for estimation of the parameters. Note that,
due to missing values this sample size may be smaller than the total sample
size per group.</li>
</ol>
<ol start="2" style="list-style-type: decimal">
<li>Assign names to the estimates
using <code>names(estimates)&lt;-c()</code>. Note that, <code>names</code> is a
character vector containing new names for the estimates in <code>estimates</code>.
Each name has to start with a letter, and may consist of “letters,”
“numbers,” “<code>.</code>” “<code>_</code>,” “<code>:</code>” “<code>~</code>,” “<code>=~</code>,” and “<code>~1</code>.”
These names are
used to specify <code>hypotheses</code>
(see below). An example is <code>names &lt;- c("a", "b", "c")</code>.</li>
<li><code>set.seed(seed)</code>. Set <code>seed</code> equal to an integer
number to create a repeatable random number sequence. <code>bain</code> uses sampling to compute Bayes factors and posterior model probabilities. It is therefore recommended to run analyses with two different seeds to ensure stability of the results.</li>
<li><code>results &lt;- bain(estimates, hypotheses, n=., Sigma=., group_parameters = 2, joint_parameters = 0, fraction = 1)</code>
executes <code>bain</code> with the
following arguments:</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><code>estimates</code> A named vector with parameter estimates.</li>
<li><code>hypotheses</code> A character string containing the informative
hypotheses to evaluate (the specification is elaborated below).</li>
<li><code>n</code> A vector containing the sample size of each group in the
analysis. See, Hoijtink, Gu, and Mulder (2019), for an elaboration of the
difference between one and multiple group analyses. A multiple group
analysis is required when group specific parameters are used to formulate
<code>hypotheses</code>. Examples are the Student’s and Welch’s t-test, ANOVA, and
ANCOVA. See the Examples section for elaborations of the specification of
multiple group analyses when a named vector is input for <code>bain</code>.</li>
<li><code>Sigma</code> A list of covariance matrices. In case of one group
analyses the list contains one covariance matrix. In case of multiple group
analyses the list contains one covariance matrix for each group. See the
Examples section and Hoijtink, Gu, and Mulder (2019) for further instructions.</li>
<li><code>group_parameters</code> The number of group specific parameters. In,
for example, an ANOVA with three groups, <code>estimates</code> will contain three
sample means, <code>group_parameters = 1</code> because each group is characterized
by one mean, and <code>joint_parameters = 0</code> because there are no parameters
that apply to each of the groups. In, for example, an ANCOVA with three
groups and two covariates, <code>estimates</code> will contain five parameters
(first the three adjusted means, followed by the regression coefficients
of the two covariates),
<code>group_parameters = 1</code> because each group is characterized by one
adjusted mean, and <code>joint_parameters = 2</code> because there are two
regression coefficients that apply to each group. In, for example, a repeated
measures design with four repeated measures and two groups (a between factor
with two levels and a within factor with four levels) <code>estimates</code> will
contain eight means (first the four for group 1, followed by the four
for group 2), <code>group_parameters = 4</code>
because each group is characterized by four means and <code>joint_parameters = 0</code> because there are no parameters that apply to each of the groups.</li>
<li><code>joint_parameters</code> In case of one group <code>joint_parameters = 0</code>. In case of two or more groups, the number of parameters in
<code>estimates</code> shared by the groups. In, for example, an ANCOVA, the number
of <code>joint_parameters</code> equals the number of covariates.</li>
<li><code>fraction = 1</code> A number representing the fraction of information in the data used to construct the prior distribution. The default value 1 denotes the minimal fraction, 2 denotes twice the minimal fraction, etc.</li>
</ol>
<ol start="5" style="list-style-type: decimal">
<li><code>print(results)</code> Print the results of an analysis with
<code>bain</code>.</li>
<li><code>summary(results, ci=0.95)</code> Present estimates and credibility intervals for the parameters used to specify the <code>hypotheses</code>. <code>ci</code> can be used to specify the confidence level of the credibility intervals.</li>
</ol>
<div id="anova-1" class="section level3" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> ANOVA</h3>
<ol style="list-style-type: decimal">
<li>Execute the statistical analysis:</li>
</ol>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="hands-on-examples-using-bain.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a factor of variable site</span></span>
<span id="cb99-2"><a href="hands-on-examples-using-bain.html#cb99-2" aria-hidden="true" tabindex="-1"></a>sesamesim<span class="sc">$</span>site <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sesamesim<span class="sc">$</span>site)</span>
<span id="cb99-3"><a href="hands-on-examples-using-bain.html#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="co"># execute an analysis of variance using lm() which, due to the -1, returns</span></span>
<span id="cb99-4"><a href="hands-on-examples-using-bain.html#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="co"># estimates of the means per group</span></span>
<span id="cb99-5"><a href="hands-on-examples-using-bain.html#cb99-5" aria-hidden="true" tabindex="-1"></a>anov <span class="ot">&lt;-</span> <span class="fu">lm</span>(postnumb<span class="sc">~</span>site<span class="dv">-1</span>,sesamesim)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>A vector containing estimates of the parameters:</li>
</ol>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="hands-on-examples-using-bain.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># collect the estimates means in a vector</span></span>
<span id="cb100-2"><a href="hands-on-examples-using-bain.html#cb100-2" aria-hidden="true" tabindex="-1"></a>estimate <span class="ot">&lt;-</span> <span class="fu">coef</span>(anov)</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Per group the sample size used for estimation of the parameters (Note: the order in this example is deliberately changed):</li>
</ol>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="hands-on-examples-using-bain.html#cb101-1" aria-hidden="true" tabindex="-1"></a>ngroup <span class="ot">&lt;-</span> <span class="fu">table</span>(sesamesim<span class="sc">$</span>site)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>A list containing, per group, the covariance
matrix of the parameters:</li>
</ol>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="hands-on-examples-using-bain.html#cb102-1" aria-hidden="true" tabindex="-1"></a>var <span class="ot">&lt;-</span> <span class="fu">summary</span>(anov)<span class="sc">$</span>sigma<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb102-2"><a href="hands-on-examples-using-bain.html#cb102-2" aria-hidden="true" tabindex="-1"></a>cov1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(var<span class="sc">/</span>ngroup[<span class="dv">1</span>], <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb102-3"><a href="hands-on-examples-using-bain.html#cb102-3" aria-hidden="true" tabindex="-1"></a>cov2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(var<span class="sc">/</span>ngroup[<span class="dv">2</span>], <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb102-4"><a href="hands-on-examples-using-bain.html#cb102-4" aria-hidden="true" tabindex="-1"></a>cov3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(var<span class="sc">/</span>ngroup[<span class="dv">3</span>], <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb102-5"><a href="hands-on-examples-using-bain.html#cb102-5" aria-hidden="true" tabindex="-1"></a>cov4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(var<span class="sc">/</span>ngroup[<span class="dv">4</span>], <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb102-6"><a href="hands-on-examples-using-bain.html#cb102-6" aria-hidden="true" tabindex="-1"></a>cov5 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(var<span class="sc">/</span>ngroup[<span class="dv">5</span>], <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb102-7"><a href="hands-on-examples-using-bain.html#cb102-7" aria-hidden="true" tabindex="-1"></a>covlist <span class="ot">&lt;-</span> <span class="fu">list</span>(cov1, cov2, cov3, cov4,cov5)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Assign names to the estimates:</li>
</ol>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="hands-on-examples-using-bain.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(estimate) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;site1&quot;</span>, <span class="st">&quot;site2&quot;</span>, <span class="st">&quot;site3&quot;</span>,<span class="st">&quot;site4&quot;</span>,<span class="st">&quot;site5&quot;</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Set seed and 4) call <code>bain</code>:</li>
</ol>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="hands-on-examples-using-bain.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb104-2"><a href="hands-on-examples-using-bain.html#cb104-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">bain</span>(estimate,</span>
<span id="cb104-3"><a href="hands-on-examples-using-bain.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;site1=site2=site3=site4=site5; site2&gt;site5&gt;site1&gt;site3&gt;site4&quot;</span>,</span>
<span id="cb104-4"><a href="hands-on-examples-using-bain.html#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="at">n=</span>ngroup,<span class="at">Sigma=</span>covlist,<span class="at">group_parameters=</span><span class="dv">1</span>,<span class="at">joint_parameters =</span> <span class="dv">0</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Print the results:</li>
</ol>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="hands-on-examples-using-bain.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class numeric:
## 
##    Fit   Com   BF.u   BF.c   PMPa  PMPb 
## H1 0.000 0.000 0.000  0.000  0.000 0.000
## H2 0.121 0.008 14.559 16.428 1.000 0.936
## Hu                                 0.064
## 
## Hypotheses:
##   H1: site1=site2=site3=site4=site5
##   H2: site2&gt;site5&gt;site1&gt;site3&gt;site4
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="hands-on-examples-using-bain.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results, <span class="at">ci =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##   Parameter  n Estimate       lb       ub
## 1     site1 60 29.66667 26.82991 32.50343
## 2     site2 55 38.98182 36.01892 41.94472
## 3     site3 64 23.18750 20.44082 25.93418
## 4     site4 43 25.32558 21.97466 28.67650
## 5     site5 18 31.72222 26.54303 36.90141</code></pre>
</div>
<div id="welchs-anova-equal-variances-not-assumed" class="section level3" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Welch’s ANOVA (equal variances not assumed)</h3>
<ol style="list-style-type: decimal">
<li>Execute the statistical analysis:</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>A vector containing estimates of the parameters:</li>
</ol>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="hands-on-examples-using-bain.html#cb109-1" aria-hidden="true" tabindex="-1"></a>sesamesim<span class="sc">$</span>site <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sesamesim<span class="sc">$</span>site)</span>
<span id="cb109-2"><a href="hands-on-examples-using-bain.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="co"># collect the estimated means in a vector</span></span>
<span id="cb109-3"><a href="hands-on-examples-using-bain.html#cb109-3" aria-hidden="true" tabindex="-1"></a>estimates <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(sesamesim<span class="sc">$</span>postnumb,<span class="fu">list</span>(sesamesim<span class="sc">$</span>site),mean)[,<span class="dv">2</span>]</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>A list containing, per group, the covariance
matrix of the parameters:</li>
</ol>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="hands-on-examples-using-bain.html#cb110-1" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(sesamesim<span class="sc">$</span>postnumb,<span class="fu">list</span>(sesamesim<span class="sc">$</span>site),var)</span>
<span id="cb110-2"><a href="hands-on-examples-using-bain.html#cb110-2" aria-hidden="true" tabindex="-1"></a>vargroup <span class="ot">&lt;-</span> vars[,<span class="dv">2</span>]<span class="sc">/</span>ngroup</span>
<span id="cb110-3"><a href="hands-on-examples-using-bain.html#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co"># collect the variances of the means in a covariance listcov1 &lt;- matrix(vargroup[1], nrow=1, ncol=1)</span></span>
<span id="cb110-4"><a href="hands-on-examples-using-bain.html#cb110-4" aria-hidden="true" tabindex="-1"></a>cov2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(vargroup[<span class="dv">2</span>], <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb110-5"><a href="hands-on-examples-using-bain.html#cb110-5" aria-hidden="true" tabindex="-1"></a>cov3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(vargroup[<span class="dv">3</span>], <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb110-6"><a href="hands-on-examples-using-bain.html#cb110-6" aria-hidden="true" tabindex="-1"></a>cov4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(vargroup[<span class="dv">4</span>], <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb110-7"><a href="hands-on-examples-using-bain.html#cb110-7" aria-hidden="true" tabindex="-1"></a>cov5 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(vargroup[<span class="dv">5</span>], <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb110-8"><a href="hands-on-examples-using-bain.html#cb110-8" aria-hidden="true" tabindex="-1"></a>covlist <span class="ot">&lt;-</span> <span class="fu">list</span>(cov1, cov2, cov3, cov4,cov5)</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Per group the sample size used for estimation of the parameters:</li>
</ol>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="hands-on-examples-using-bain.html#cb111-1" aria-hidden="true" tabindex="-1"></a>ngroup <span class="ot">&lt;-</span> <span class="fu">table</span>(sesamesim<span class="sc">$</span>site)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Assign names to the estimates:</li>
</ol>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="hands-on-examples-using-bain.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(estimates) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;site1&quot;</span>, <span class="st">&quot;site2&quot;</span>, <span class="st">&quot;site3&quot;</span>,<span class="st">&quot;site4&quot;</span>,<span class="st">&quot;site5&quot;</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Set seed and 4) call <code>bain</code>:</li>
</ol>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="hands-on-examples-using-bain.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb113-2"><a href="hands-on-examples-using-bain.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="co"># test hypotheses using bain. Note that there are multiple groups</span></span>
<span id="cb113-3"><a href="hands-on-examples-using-bain.html#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="co"># characterized by one mean, therefore group_parameters=1. Note that</span></span>
<span id="cb113-4"><a href="hands-on-examples-using-bain.html#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co"># there are no joint parameters, therefore, joint_parameters=0.</span></span>
<span id="cb113-5"><a href="hands-on-examples-using-bain.html#cb113-5" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">bain</span>(estimates,</span>
<span id="cb113-6"><a href="hands-on-examples-using-bain.html#cb113-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;site1=site2=site3=site4=site5;site2&gt;site5&gt;site1&gt;site4&gt;site3&quot;</span>,</span>
<span id="cb113-7"><a href="hands-on-examples-using-bain.html#cb113-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">n=</span>ngroup,<span class="at">Sigma=</span>covlist,<span class="at">group_parameters=</span><span class="dv">1</span>,<span class="at">joint_parameters =</span> <span class="dv">0</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Print the results:</li>
</ol>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="hands-on-examples-using-bain.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class numeric:
## 
##    Fit   Com   BF.u   BF.c    PMPa  PMPb 
## H1 0.000 0.000 0.000  0.000   0.000 0.000
## H2 0.656 0.011 59.258 170.335 1.000 0.983
## Hu                                  0.017
## 
## Hypotheses:
##   H1: site1=site2=site3=site4=site5
##   H2: site2&gt;site5&gt;site1&gt;site4&gt;site3
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="hands-on-examples-using-bain.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results, <span class="at">ci =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##   Parameter  n Estimate       lb       ub
## 1     site1 60 29.66667 26.82991 32.50343
## 2     site2 55 38.98182 35.54861 42.41503
## 3     site3 64 23.18750 20.40407 25.97093
## 4     site4 43 25.32558 22.65323 27.99793
## 5     site5 18 31.72222 27.79013 35.65432</code></pre>
</div>
<div id="robust-anova-against-non-normality" class="section level3" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Robust ANOVA (against non-normality)</h3>
<p>Load the <code>WRS2</code> package which renders the trimmed sample mean and
corresponding standard error:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="hands-on-examples-using-bain.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(WRS2)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Execute the statistical analysis:</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>A vector containing estimates of the parameters:</li>
</ol>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="hands-on-examples-using-bain.html#cb119-1" aria-hidden="true" tabindex="-1"></a>sesamesim<span class="sc">$</span>site <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sesamesim<span class="sc">$</span>site)</span>
<span id="cb119-2"><a href="hands-on-examples-using-bain.html#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the 20\% sample trimmed mean for each site</span></span>
<span id="cb119-3"><a href="hands-on-examples-using-bain.html#cb119-3" aria-hidden="true" tabindex="-1"></a>estimates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(sesamesim<span class="sc">$</span>postnumb[sesamesim<span class="sc">$</span>site <span class="sc">==</span> <span class="dv">1</span>], <span class="at">tr =</span> <span class="fl">0.2</span>),</span>
<span id="cb119-4"><a href="hands-on-examples-using-bain.html#cb119-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mean</span>(sesamesim<span class="sc">$</span>postnumb[sesamesim<span class="sc">$</span>site <span class="sc">==</span> <span class="dv">2</span>], <span class="at">tr =</span> <span class="fl">0.2</span>),</span>
<span id="cb119-5"><a href="hands-on-examples-using-bain.html#cb119-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mean</span>(sesamesim<span class="sc">$</span>postnumb[sesamesim<span class="sc">$</span>site <span class="sc">==</span> <span class="dv">3</span>], <span class="at">tr =</span> <span class="fl">0.2</span>),</span>
<span id="cb119-6"><a href="hands-on-examples-using-bain.html#cb119-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mean</span>(sesamesim<span class="sc">$</span>postnumb[sesamesim<span class="sc">$</span>site <span class="sc">==</span> <span class="dv">4</span>], <span class="at">tr =</span> <span class="fl">0.2</span>),</span>
<span id="cb119-7"><a href="hands-on-examples-using-bain.html#cb119-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mean</span>(sesamesim<span class="sc">$</span>postnumb[sesamesim<span class="sc">$</span>site <span class="sc">==</span> <span class="dv">5</span>], <span class="at">tr =</span> <span class="fl">0.2</span>))</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>A list containing, per group, the covariance
matrix of the parameters:</li>
</ol>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="hands-on-examples-using-bain.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the sample trimmed mean standard error for each site</span></span>
<span id="cb120-2"><a href="hands-on-examples-using-bain.html#cb120-2" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">trimse</span>(sesamesim<span class="sc">$</span>postnumb[sesamesim<span class="sc">$</span>site <span class="sc">==</span> <span class="dv">1</span>]),</span>
<span id="cb120-3"><a href="hands-on-examples-using-bain.html#cb120-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">trimse</span>(sesamesim<span class="sc">$</span>postnumb[sesamesim<span class="sc">$</span>site <span class="sc">==</span> <span class="dv">2</span>]),</span>
<span id="cb120-4"><a href="hands-on-examples-using-bain.html#cb120-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">trimse</span>(sesamesim<span class="sc">$</span>postnumb[sesamesim<span class="sc">$</span>site <span class="sc">==</span> <span class="dv">3</span>]),</span>
<span id="cb120-5"><a href="hands-on-examples-using-bain.html#cb120-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">trimse</span>(sesamesim<span class="sc">$</span>postnumb[sesamesim<span class="sc">$</span>site <span class="sc">==</span> <span class="dv">4</span>]),</span>
<span id="cb120-6"><a href="hands-on-examples-using-bain.html#cb120-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">trimse</span>(sesamesim<span class="sc">$</span>postnumb[sesamesim<span class="sc">$</span>site <span class="sc">==</span> <span class="dv">5</span>]))</span>
<span id="cb120-7"><a href="hands-on-examples-using-bain.html#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Square the standard errors to obtain the variances of the sample</span></span>
<span id="cb120-8"><a href="hands-on-examples-using-bain.html#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="co"># trimmed means</span></span>
<span id="cb120-9"><a href="hands-on-examples-using-bain.html#cb120-9" aria-hidden="true" tabindex="-1"></a>var <span class="ot">&lt;-</span> se<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb120-10"><a href="hands-on-examples-using-bain.html#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Store the variances in a list of matrices</span></span>
<span id="cb120-11"><a href="hands-on-examples-using-bain.html#cb120-11" aria-hidden="true" tabindex="-1"></a>covlist <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">matrix</span>(var[<span class="dv">1</span>]),<span class="fu">matrix</span>(var[<span class="dv">2</span>]),</span>
<span id="cb120-12"><a href="hands-on-examples-using-bain.html#cb120-12" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(var[<span class="dv">3</span>]),<span class="fu">matrix</span>(var[<span class="dv">4</span>]), <span class="fu">matrix</span>(var[<span class="dv">5</span>]))</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Per group the sample size used for estimation of the parameters:</li>
</ol>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="hands-on-examples-using-bain.html#cb121-1" aria-hidden="true" tabindex="-1"></a>ngroup <span class="ot">&lt;-</span> <span class="fu">table</span>(sesamesim<span class="sc">$</span>site)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Assign names to the estimates:</li>
</ol>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="hands-on-examples-using-bain.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(estimates) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;s1&quot;</span>, <span class="st">&quot;s2&quot;</span>, <span class="st">&quot;s3&quot;</span>,<span class="st">&quot;s4&quot;</span>,<span class="st">&quot;s5&quot;</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Set seed and 4) call <code>bain</code>:</li>
</ol>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="hands-on-examples-using-bain.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb123-2"><a href="hands-on-examples-using-bain.html#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="co"># test hypotheses with bain</span></span>
<span id="cb123-3"><a href="hands-on-examples-using-bain.html#cb123-3" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">bain</span>(estimates,<span class="st">&quot;s1=s2=s3=s4=s5;s2&gt;s5&gt;s1&gt;s3&gt;s4&quot;</span>,</span>
<span id="cb123-4"><a href="hands-on-examples-using-bain.html#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="at">n=</span>ngroup,<span class="at">Sigma=</span>covlist,<span class="at">group_parameters=</span><span class="dv">1</span>,<span class="at">joint_parameters=</span> <span class="dv">0</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Print the results:</li>
</ol>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="hands-on-examples-using-bain.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class numeric:
## 
##    Fit   Com   BF.u   BF.c   PMPa  PMPb 
## H1 0.000 0.000 0.000  0.000  0.000 0.000
## H2 0.076 0.007 10.407 11.185 1.000 0.912
## Hu                                 0.088
## 
## Hypotheses:
##   H1: s1=s2=s3=s4=s5
##   H2: s2&gt;s5&gt;s1&gt;s3&gt;s4
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="hands-on-examples-using-bain.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results, <span class="at">ci =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##   Parameter  n Estimate       lb       ub
## 1        s1 60 29.69444 27.11542 32.27347
## 2        s2 55 39.63636 35.93878 43.33394
## 3        s3 64 22.95000 20.04036 25.85964
## 4        s4 43 25.29630 22.98708 27.60551
## 5        s5 18 31.75000 26.06594 37.43406</code></pre>
</div>
<div id="ancova-1" class="section level3" number="3.4.4">
<h3><span class="header-section-number">3.4.4</span> ANCOVA</h3>
<ol style="list-style-type: decimal">
<li>Execute the statistical analysis:</li>
</ol>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="hands-on-examples-using-bain.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a factor of variable site</span></span>
<span id="cb128-2"><a href="hands-on-examples-using-bain.html#cb128-2" aria-hidden="true" tabindex="-1"></a>sesamesim<span class="sc">$</span>site <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sesamesim<span class="sc">$</span>site)</span>
<span id="cb128-3"><a href="hands-on-examples-using-bain.html#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="co"># center the covariate. If centered the coef() command below displays the</span></span>
<span id="cb128-4"><a href="hands-on-examples-using-bain.html#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="co"># adjusted means. If not centered the intercepts are displayed.</span></span>
<span id="cb128-5"><a href="hands-on-examples-using-bain.html#cb128-5" aria-hidden="true" tabindex="-1"></a>sesamesim<span class="sc">$</span>prenumb <span class="ot">&lt;-</span> sesamesim<span class="sc">$</span>prenumb <span class="sc">-</span> <span class="fu">mean</span>(sesamesim<span class="sc">$</span>prenumb)</span>
<span id="cb128-6"><a href="hands-on-examples-using-bain.html#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="co"># execute an analysis of covariance using lm() which, due to the -1, returns</span></span>
<span id="cb128-7"><a href="hands-on-examples-using-bain.html#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="co"># estimates of the adjusted means per group</span></span>
<span id="cb128-8"><a href="hands-on-examples-using-bain.html#cb128-8" aria-hidden="true" tabindex="-1"></a>ancov2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(postnumb<span class="sc">~</span>site<span class="sc">+</span>prenumb<span class="dv">-1</span>,sesamesim)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>A vector containing estimates of the parameters:</li>
</ol>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="hands-on-examples-using-bain.html#cb129-1" aria-hidden="true" tabindex="-1"></a>estimates <span class="ot">&lt;-</span> <span class="fu">coef</span>(ancov2)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>A list containing, per group, the covariance
matrix of the parameters:</li>
</ol>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="hands-on-examples-using-bain.html#cb130-1" aria-hidden="true" tabindex="-1"></a>var <span class="ot">&lt;-</span> (<span class="fu">summary</span>(ancov2)<span class="sc">$</span>sigma)<span class="sc">**</span><span class="dv">2</span></span>
<span id="cb130-2"><a href="hands-on-examples-using-bain.html#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="co"># below, for each group, the covariance matrix of the adjusted mean and</span></span>
<span id="cb130-3"><a href="hands-on-examples-using-bain.html#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="co"># covariate is computed</span></span>
<span id="cb130-4"><a href="hands-on-examples-using-bain.html#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="co"># see Hoijtink, Gu, and Mulder (2019) for further explanation and elaboration</span></span>
<span id="cb130-5"><a href="hands-on-examples-using-bain.html#cb130-5" aria-hidden="true" tabindex="-1"></a>cat1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">cbind</span>(sesamesim<span class="sc">$</span>site,sesamesim<span class="sc">$</span>prenumb), sesamesim<span class="sc">$</span>site <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb130-6"><a href="hands-on-examples-using-bain.html#cb130-6" aria-hidden="true" tabindex="-1"></a>cat1[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb130-7"><a href="hands-on-examples-using-bain.html#cb130-7" aria-hidden="true" tabindex="-1"></a>cat1 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(cat1)</span>
<span id="cb130-8"><a href="hands-on-examples-using-bain.html#cb130-8" aria-hidden="true" tabindex="-1"></a>cov1 <span class="ot">&lt;-</span> var <span class="sc">*</span> <span class="fu">solve</span>(<span class="fu">t</span>(cat1) <span class="sc">%*%</span> cat1)</span>
<span id="cb130-9"><a href="hands-on-examples-using-bain.html#cb130-9" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb130-10"><a href="hands-on-examples-using-bain.html#cb130-10" aria-hidden="true" tabindex="-1"></a>cat2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">cbind</span>(sesamesim<span class="sc">$</span>site,sesamesim<span class="sc">$</span>prenumb), sesamesim<span class="sc">$</span>site <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb130-11"><a href="hands-on-examples-using-bain.html#cb130-11" aria-hidden="true" tabindex="-1"></a>cat2[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb130-12"><a href="hands-on-examples-using-bain.html#cb130-12" aria-hidden="true" tabindex="-1"></a>cat2 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(cat2)</span>
<span id="cb130-13"><a href="hands-on-examples-using-bain.html#cb130-13" aria-hidden="true" tabindex="-1"></a>cov2 <span class="ot">&lt;-</span> var <span class="sc">*</span> <span class="fu">solve</span>(<span class="fu">t</span>(cat2) <span class="sc">%*%</span> cat2)</span>
<span id="cb130-14"><a href="hands-on-examples-using-bain.html#cb130-14" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb130-15"><a href="hands-on-examples-using-bain.html#cb130-15" aria-hidden="true" tabindex="-1"></a>cat3 <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">cbind</span>(sesamesim<span class="sc">$</span>site,sesamesim<span class="sc">$</span>prenumb), sesamesim<span class="sc">$</span>site <span class="sc">==</span> <span class="dv">3</span>)</span>
<span id="cb130-16"><a href="hands-on-examples-using-bain.html#cb130-16" aria-hidden="true" tabindex="-1"></a>cat3[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb130-17"><a href="hands-on-examples-using-bain.html#cb130-17" aria-hidden="true" tabindex="-1"></a>cat3 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(cat3)</span>
<span id="cb130-18"><a href="hands-on-examples-using-bain.html#cb130-18" aria-hidden="true" tabindex="-1"></a>cov3 <span class="ot">&lt;-</span> var <span class="sc">*</span> <span class="fu">solve</span>(<span class="fu">t</span>(cat3) <span class="sc">%*%</span> cat3)</span>
<span id="cb130-19"><a href="hands-on-examples-using-bain.html#cb130-19" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb130-20"><a href="hands-on-examples-using-bain.html#cb130-20" aria-hidden="true" tabindex="-1"></a>cat4 <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">cbind</span>(sesamesim<span class="sc">$</span>site,sesamesim<span class="sc">$</span>prenumb), sesamesim<span class="sc">$</span>site <span class="sc">==</span> <span class="dv">4</span>)</span>
<span id="cb130-21"><a href="hands-on-examples-using-bain.html#cb130-21" aria-hidden="true" tabindex="-1"></a>cat4[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb130-22"><a href="hands-on-examples-using-bain.html#cb130-22" aria-hidden="true" tabindex="-1"></a>cat4 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(cat4)</span>
<span id="cb130-23"><a href="hands-on-examples-using-bain.html#cb130-23" aria-hidden="true" tabindex="-1"></a>cov4 <span class="ot">&lt;-</span> var <span class="sc">*</span> <span class="fu">solve</span>(<span class="fu">t</span>(cat4) <span class="sc">%*%</span> cat4)</span>
<span id="cb130-24"><a href="hands-on-examples-using-bain.html#cb130-24" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb130-25"><a href="hands-on-examples-using-bain.html#cb130-25" aria-hidden="true" tabindex="-1"></a>cat5 <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">cbind</span>(sesamesim<span class="sc">$</span>site,sesamesim<span class="sc">$</span>prenumb), sesamesim<span class="sc">$</span>site <span class="sc">==</span> <span class="dv">5</span>)</span>
<span id="cb130-26"><a href="hands-on-examples-using-bain.html#cb130-26" aria-hidden="true" tabindex="-1"></a>cat5[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb130-27"><a href="hands-on-examples-using-bain.html#cb130-27" aria-hidden="true" tabindex="-1"></a>cat5 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(cat5)</span>
<span id="cb130-28"><a href="hands-on-examples-using-bain.html#cb130-28" aria-hidden="true" tabindex="-1"></a>cov5 <span class="ot">&lt;-</span> var <span class="sc">*</span> <span class="fu">solve</span>(<span class="fu">t</span>(cat5) <span class="sc">%*%</span> cat5)</span>
<span id="cb130-29"><a href="hands-on-examples-using-bain.html#cb130-29" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb130-30"><a href="hands-on-examples-using-bain.html#cb130-30" aria-hidden="true" tabindex="-1"></a>covariances <span class="ot">&lt;-</span> <span class="fu">list</span>(cov1, cov2, cov3, cov4,cov5)</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Per group the sample size used for estimation of the parameters:</li>
</ol>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="hands-on-examples-using-bain.html#cb131-1" aria-hidden="true" tabindex="-1"></a>ngroup <span class="ot">&lt;-</span> <span class="fu">table</span>(sesamesim<span class="sc">$</span>site)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Assign names to the estimates:</li>
</ol>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="hands-on-examples-using-bain.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(estimates)<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;v.1&quot;</span>, <span class="st">&quot;v.2&quot;</span>, <span class="st">&quot;v.3&quot;</span>, <span class="st">&quot;v.4&quot;</span>,<span class="st">&quot;v.5&quot;</span>, <span class="st">&quot;pre&quot;</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Set seed and 4) call <code>bain</code>:</li>
</ol>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="hands-on-examples-using-bain.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb133-2"><a href="hands-on-examples-using-bain.html#cb133-2" aria-hidden="true" tabindex="-1"></a>results2<span class="ot">&lt;-</span><span class="fu">bain</span>(estimates,<span class="st">&quot;v.1=v.2=v.3=v.4=v.5;v.2 &gt; v.5 &gt; v.1 &gt; v.3 &gt;v.4;&quot;</span>,</span>
<span id="cb133-3"><a href="hands-on-examples-using-bain.html#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="at">n=</span>ngroup,<span class="at">Sigma=</span>covariances,<span class="at">group_parameters=</span><span class="dv">1</span>,<span class="at">joint_parameters =</span> <span class="dv">1</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Print the results:</li>
</ol>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="hands-on-examples-using-bain.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class numeric:
## 
##    Fit   Com   BF.u   BF.c   PMPa  PMPb 
## H1 0.000 0.000 0.000  0.000  0.000 0.000
## H2 0.076 0.007 10.407 11.185 1.000 0.912
## Hu                                 0.088
## 
## Hypotheses:
##   H1: s1=s2=s3=s4=s5
##   H2: s2&gt;s5&gt;s1&gt;s3&gt;s4
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="hands-on-examples-using-bain.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results, <span class="at">ci =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##   Parameter  n Estimate       lb       ub
## 1        s1 60 29.69444 27.11542 32.27347
## 2        s2 55 39.63636 35.93878 43.33394
## 3        s3 64 22.95000 20.04036 25.85964
## 4        s4 43 25.29630 22.98708 27.60551
## 5        s5 18 31.75000 26.06594 37.43406</code></pre>
</div>
<div id="one-within-factor-repeated-measures-analysis" class="section level3" number="3.4.5">
<h3><span class="header-section-number">3.4.5</span> One within factor repeated measures analysis</h3>
<ol style="list-style-type: decimal">
<li>Execute the statistical analysis:</li>
</ol>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="hands-on-examples-using-bain.html#cb138-1" aria-hidden="true" tabindex="-1"></a>within <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">cbind</span>(prenumb,postnumb,funumb)<span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span>sesamesim)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>A vector containing estimates of the parameters:</li>
</ol>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="hands-on-examples-using-bain.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># collect the estimates means in a vector</span></span>
<span id="cb139-2"><a href="hands-on-examples-using-bain.html#cb139-2" aria-hidden="true" tabindex="-1"></a>estimate <span class="ot">&lt;-</span> <span class="fu">coef</span>(within)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>A list containing, per group, the covariance
matrix of the parameters:</li>
</ol>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="hands-on-examples-using-bain.html#cb140-1" aria-hidden="true" tabindex="-1"></a>covmatr <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">vcov</span>(within))</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Per group the sample size used for estimation of the parameters:</li>
</ol>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="hands-on-examples-using-bain.html#cb141-1" aria-hidden="true" tabindex="-1"></a>ngroup <span class="ot">&lt;-</span> <span class="fu">nrow</span>(sesamesim)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Assign names to the estimates:</li>
</ol>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="hands-on-examples-using-bain.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(estimate) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;pre&quot;</span>, <span class="st">&quot;post&quot;</span>, <span class="st">&quot;fu&quot;</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Set seed and 4) call <code>bain</code>:</li>
</ol>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="hands-on-examples-using-bain.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb143-2"><a href="hands-on-examples-using-bain.html#cb143-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">bain</span>(estimate,<span class="st">&quot;pre = post = fu; pre &lt; post &lt; fu&quot;</span>, <span class="at">n=</span>ngroup,</span>
<span id="cb143-3"><a href="hands-on-examples-using-bain.html#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="at">Sigma=</span>covmatr, <span class="at">group_parameters=</span><span class="dv">3</span>, <span class="at">joint_parameters =</span> <span class="dv">0</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Print the results:</li>
</ol>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="hands-on-examples-using-bain.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class numeric:
## 
##    Fit   Com   BF.u  BF.c       PMPa  PMPb 
## H1 0.000 0.002 0.000 0.000      0.000 0.000
## H2 1.000 0.243 4.115 237946.392 1.000 0.805
## Hu                                    0.195
## 
## Hypotheses:
##   H1: pre=post=fu
##   H2: pre&lt;post&lt;fu
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="hands-on-examples-using-bain.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results, <span class="at">ci =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##   Parameter   n     Estimate        lb        ub
## 1       pre 240 4.586534e-16 -1.343254  1.343254
## 2      post 240 2.945000e+01 27.857428 31.042572
## 3        fu 240 3.432083e+01 31.750376 36.891290</code></pre>
</div>
<div id="one-between-within-factor-repeated-measures-analysis" class="section level3" number="3.4.6">
<h3><span class="header-section-number">3.4.6</span> One between-within factor repeated measures analysis</h3>
<ol style="list-style-type: decimal">
<li>Execute the statistical analysis:</li>
</ol>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="hands-on-examples-using-bain.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a factor of the variable sex</span></span>
<span id="cb148-2"><a href="hands-on-examples-using-bain.html#cb148-2" aria-hidden="true" tabindex="-1"></a>sesamesim<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(sesamesim<span class="sc">$</span>sex)</span>
<span id="cb148-3"><a href="hands-on-examples-using-bain.html#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the means of prenumb, postnumb, and funumb for boys and girls</span></span>
<span id="cb148-4"><a href="hands-on-examples-using-bain.html#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the -1 denotes that the means have to estimated</span></span>
<span id="cb148-5"><a href="hands-on-examples-using-bain.html#cb148-5" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">cbind</span>(prenumb, postnumb, funumb)<span class="sc">~</span>sex<span class="dv">-1</span>, <span class="at">data=</span>sesamesim)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>A vector containing estimates of the parameters:</li>
</ol>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="hands-on-examples-using-bain.html#cb149-1" aria-hidden="true" tabindex="-1"></a>est1 <span class="ot">&lt;-</span><span class="fu">coef</span>(bw)[<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="co"># the three means for sex = 1</span></span>
<span id="cb149-2"><a href="hands-on-examples-using-bain.html#cb149-2" aria-hidden="true" tabindex="-1"></a>est2 <span class="ot">&lt;-</span><span class="fu">coef</span>(bw)[<span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="co"># the three means for sex = 2</span></span>
<span id="cb149-3"><a href="hands-on-examples-using-bain.html#cb149-3" aria-hidden="true" tabindex="-1"></a>estimate <span class="ot">&lt;-</span> <span class="fu">c</span>(est1,est2)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>A list containing, per group, the covariance
matrix of the parameters:</li>
</ol>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="hands-on-examples-using-bain.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cov1 has to contain the covariance matrix of the three means in group 1.</span></span>
<span id="cb150-2"><a href="hands-on-examples-using-bain.html#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="co"># cov2 has to contain the covariance matrix in group 2</span></span>
<span id="cb150-3"><a href="hands-on-examples-using-bain.html#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="co"># typing vcov(bw) in the console pane highlights the structure of</span></span>
<span id="cb150-4"><a href="hands-on-examples-using-bain.html#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the covariance matrix of all 3+3=6 means</span></span>
<span id="cb150-5"><a href="hands-on-examples-using-bain.html#cb150-5" aria-hidden="true" tabindex="-1"></a><span class="co"># it has to be dissected in to cov1 and cov2</span></span>
<span id="cb150-6"><a href="hands-on-examples-using-bain.html#cb150-6" aria-hidden="true" tabindex="-1"></a>cov1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">vcov</span>(bw)[<span class="dv">1</span>,<span class="dv">1</span>],<span class="fu">vcov</span>(bw)[<span class="dv">1</span>,<span class="dv">3</span>],<span class="fu">vcov</span>(bw)[<span class="dv">1</span>,<span class="dv">5</span>],<span class="fu">vcov</span>(bw)[<span class="dv">3</span>,<span class="dv">1</span>],</span>
<span id="cb150-7"><a href="hands-on-examples-using-bain.html#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(bw)[<span class="dv">3</span>,<span class="dv">3</span>],<span class="fu">vcov</span>(bw)[<span class="dv">3</span>,<span class="dv">5</span>],<span class="fu">vcov</span>(bw)[<span class="dv">5</span>,<span class="dv">1</span>],<span class="fu">vcov</span>(bw)[<span class="dv">5</span>,<span class="dv">3</span>],<span class="fu">vcov</span>(bw)[<span class="dv">5</span>,<span class="dv">5</span>])</span>
<span id="cb150-8"><a href="hands-on-examples-using-bain.html#cb150-8" aria-hidden="true" tabindex="-1"></a>cov1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(cov1,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb150-9"><a href="hands-on-examples-using-bain.html#cb150-9" aria-hidden="true" tabindex="-1"></a>cov2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">vcov</span>(bw)[<span class="dv">2</span>,<span class="dv">2</span>],<span class="fu">vcov</span>(bw)[<span class="dv">2</span>,<span class="dv">4</span>],<span class="fu">vcov</span>(bw)[<span class="dv">2</span>,<span class="dv">6</span>],<span class="fu">vcov</span>(bw)[<span class="dv">4</span>,<span class="dv">2</span>],</span>
<span id="cb150-10"><a href="hands-on-examples-using-bain.html#cb150-10" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(bw)[<span class="dv">4</span>,<span class="dv">4</span>],<span class="fu">vcov</span>(bw)[<span class="dv">4</span>,<span class="dv">6</span>],<span class="fu">vcov</span>(bw)[<span class="dv">6</span>,<span class="dv">2</span>],<span class="fu">vcov</span>(bw)[<span class="dv">6</span>,<span class="dv">4</span>],<span class="fu">vcov</span>(bw)[<span class="dv">6</span>,<span class="dv">6</span>])</span>
<span id="cb150-11"><a href="hands-on-examples-using-bain.html#cb150-11" aria-hidden="true" tabindex="-1"></a>cov2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(cov2,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb150-12"><a href="hands-on-examples-using-bain.html#cb150-12" aria-hidden="true" tabindex="-1"></a>covariance<span class="ot">&lt;-</span><span class="fu">list</span>(cov1,cov2)</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Per group the sample size used for estimation of the parameters:</li>
</ol>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="hands-on-examples-using-bain.html#cb151-1" aria-hidden="true" tabindex="-1"></a>ngroup<span class="ot">&lt;-</span><span class="fu">table</span>(sesamesim<span class="sc">$</span>sex)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Assign names to the estimates:</li>
</ol>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="hands-on-examples-using-bain.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(estimate) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;pre1&quot;</span>, <span class="st">&quot;post1&quot;</span>, <span class="st">&quot;fu1&quot;</span>,<span class="st">&quot;pre2&quot;</span>, <span class="st">&quot;post2&quot;</span>, <span class="st">&quot;fu2&quot;</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Set seed and 4) call <code>bain</code>:</li>
</ol>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="hands-on-examples-using-bain.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb153-2"><a href="hands-on-examples-using-bain.html#cb153-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span><span class="fu">bain</span>(estimate, <span class="st">&quot;pre1 - pre2 = post1 - post2 = fu1 -fu2;</span></span>
<span id="cb153-3"><a href="hands-on-examples-using-bain.html#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="st">pre1 - pre2 &gt; post1 - post2 &gt; fu1 -fu2&quot;</span>  , <span class="at">n=</span>ngroup, <span class="at">Sigma=</span>covariance,</span>
<span id="cb153-4"><a href="hands-on-examples-using-bain.html#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="at">group_parameters=</span><span class="dv">3</span>, <span class="at">joint_parameters =</span> <span class="dv">0</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Print the results:</li>
</ol>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="hands-on-examples-using-bain.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class numeric:
## 
##    Fit   Com   BF.u    BF.c    PMPa  PMPb 
## H1 0.052 0.000 111.145 111.145 0.994 0.985
## H2 0.175 0.243 0.722   0.663   0.006 0.006
## Hu                                   0.009
## 
## Hypotheses:
##   H1: pre1-pre2=post1-post2=fu1-fu2
##   H2: pre1-pre2&gt;post1-post2&gt;fu1-fu2
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="hands-on-examples-using-bain.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results, <span class="at">ci =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##   Parameter   n   Estimate        lb        ub
## 1      pre1 115  0.3981884 -1.545126  2.341503
## 2     post1 115 30.0956522 27.792949 32.398355
## 3       fu1 115 34.9043478 31.184613 38.624082
## 4      pre2 125 -0.3663333 -2.230295  1.497629
## 5     post2 125 28.8560000 26.647325 31.064675
## 6       fu2 125 33.7840000 30.216156 37.351844</code></pre>
</div>
<div id="logistic-regression-1" class="section level3" number="3.4.7">
<h3><span class="header-section-number">3.4.7</span> Logistic regression (1)</h3>
<p><em>This example is presented as a counterpart of multiple regression.</em></p>
<p>Regression coefficients can only be mutually compared if the corresponding predictors are measured on the same scale, therefore the predictors are standardized</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="hands-on-examples-using-bain.html#cb158-1" aria-hidden="true" tabindex="-1"></a>sesamesim<span class="sc">$</span>age <span class="ot">&lt;-</span> (sesamesim<span class="sc">$</span>age <span class="sc">-</span> <span class="fu">mean</span>(sesamesim<span class="sc">$</span>age))<span class="sc">/</span><span class="fu">sd</span>(sesamesim<span class="sc">$</span>age)</span>
<span id="cb158-2"><a href="hands-on-examples-using-bain.html#cb158-2" aria-hidden="true" tabindex="-1"></a>sesamesim<span class="sc">$</span>peabody <span class="ot">&lt;-</span> (sesamesim<span class="sc">$</span>peabody <span class="sc">-</span> <span class="fu">mean</span>(sesamesim<span class="sc">$</span>peabody))<span class="sc">/</span></span>
<span id="cb158-3"><a href="hands-on-examples-using-bain.html#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(sesamesim<span class="sc">$</span>peabody)</span>
<span id="cb158-4"><a href="hands-on-examples-using-bain.html#cb158-4" aria-hidden="true" tabindex="-1"></a>sesamesim<span class="sc">$</span>prenumb <span class="ot">&lt;-</span> (sesamesim<span class="sc">$</span>prenumb <span class="sc">-</span> <span class="fu">mean</span>(sesamesim<span class="sc">$</span>prenumb))<span class="sc">/</span></span>
<span id="cb158-5"><a href="hands-on-examples-using-bain.html#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(sesamesim<span class="sc">$</span>prenumb)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Execute the statistical analysis:</li>
</ol>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="hands-on-examples-using-bain.html#cb159-1" aria-hidden="true" tabindex="-1"></a>logreg <span class="ot">&lt;-</span> <span class="fu">glm</span>(viewenc <span class="sc">~</span> age <span class="sc">+</span> peabody <span class="sc">+</span> prenumb, <span class="at">family=</span>binomial,</span>
<span id="cb159-2"><a href="hands-on-examples-using-bain.html#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="at">data=</span>sesamesim)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>A vector containing estimates of the parameters:</li>
</ol>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="hands-on-examples-using-bain.html#cb160-1" aria-hidden="true" tabindex="-1"></a>estimate <span class="ot">&lt;-</span> <span class="fu">coef</span>(logreg)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>A list containing, per group, the covariance
matrix of the parameters:</li>
</ol>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="hands-on-examples-using-bain.html#cb161-1" aria-hidden="true" tabindex="-1"></a>covmatr <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">vcov</span>(logreg))</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Per group the sample size used for estimation of the parameters:</li>
</ol>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="hands-on-examples-using-bain.html#cb162-1" aria-hidden="true" tabindex="-1"></a>ngroup <span class="ot">&lt;-</span> <span class="fu">nrow</span>(sesamesim)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Assign names to the estimates:</li>
</ol>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="hands-on-examples-using-bain.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(estimate) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;int&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;peab&quot;</span> ,<span class="st">&quot;pre&quot;</span> )</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Set seed and 4) call <code>bain</code>:</li>
</ol>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="hands-on-examples-using-bain.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb164-2"><a href="hands-on-examples-using-bain.html#cb164-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">bain</span>(estimate, <span class="st">&quot;age = peab = pre; age &gt; pre &gt; peab&quot;</span>, <span class="at">n=</span>ngroup,</span>
<span id="cb164-3"><a href="hands-on-examples-using-bain.html#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="at">Sigma=</span>covmatr, <span class="at">group_parameters=</span><span class="dv">4</span>, <span class="at">joint_parameters =</span> <span class="dv">0</span>)</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Print the results:</li>
</ol>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="hands-on-examples-using-bain.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class numeric:
## 
##    Fit   Com   BF.u  BF.c   PMPa  PMPb 
## H1 0.176 0.018 9.865 9.865  0.682 0.638
## H2 0.611 0.133 4.605 10.257 0.318 0.298
## Hu                                0.065
## 
## Hypotheses:
##   H1: age=peab=pre
##   H2: age&gt;pre&gt;peab
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="hands-on-examples-using-bain.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results, <span class="at">ci =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##   Parameter   n    Estimate         lb            ub
## 1       int 240 -1.18057044 -1.4856839 -0.8754569440
## 2       age 240  0.19968233 -0.1224419  0.5218065630
## 3      peab 240 -0.38378044 -0.7684559  0.0008950488
## 4       pre 240  0.01367146 -0.3745181  0.4018610168</code></pre>
</div>
<div id="logistic-regression-2" class="section level3" number="3.4.8">
<h3><span class="header-section-number">3.4.8</span> Logistic regression (2)</h3>
<p><em>This example is presented as a counterpart of an ANCOVA, based on <span class="citation"><a href="references.html#ref-hoijtink2019bayesian" role="doc-biblioref">Hoijtink, Gu, &amp; Mulder</a> (<a href="references.html#ref-hoijtink2019bayesian" role="doc-biblioref">2019</a>)</span>.</em></p>
<p>The research question concerns the probability of encouragement to view
sesame street (a dichotomous 0/1 meaning no/yes dependent variable) for
boys (sex=1) and girls (sex=2) adjusted for their age. This is a kind of
ANCOVA with a dichotomous instead of a continuous dependent variable.</p>
<p>Load the <code>numDeriv</code> package which will be used to compute the covariance matrix of the adjusted group coefficients and regression coefficient of age for the boys and the girls # using the estimates obtained using the data for the boys AND the girls.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="hands-on-examples-using-bain.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(numDeriv)</span></code></pre></div>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="hands-on-examples-using-bain.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a factor of the variable sex</span></span>
<span id="cb170-2"><a href="hands-on-examples-using-bain.html#cb170-2" aria-hidden="true" tabindex="-1"></a>sesamesim<span class="sc">$</span>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(sesamesim<span class="sc">$</span>sex)</span>
<span id="cb170-3"><a href="hands-on-examples-using-bain.html#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="co"># center the covariate age</span></span>
<span id="cb170-4"><a href="hands-on-examples-using-bain.html#cb170-4" aria-hidden="true" tabindex="-1"></a>sesamesim<span class="sc">$</span>age <span class="ot">&lt;-</span> sesamesim<span class="sc">$</span>age <span class="sc">-</span> <span class="fu">mean</span>(sesamesim<span class="sc">$</span>age)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Execute the statistical analysis:</li>
</ol>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="hands-on-examples-using-bain.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># execute the logistic regression, -1 ensures that the coefficients</span></span>
<span id="cb171-2"><a href="hands-on-examples-using-bain.html#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for boys and girl are estimated adjusted for the covariate age</span></span>
<span id="cb171-3"><a href="hands-on-examples-using-bain.html#cb171-3" aria-hidden="true" tabindex="-1"></a>anal <span class="ot">&lt;-</span> <span class="fu">glm</span>(viewenc <span class="sc">~</span> sex <span class="sc">+</span> age <span class="sc">-</span> <span class="dv">1</span>, <span class="at">family=</span>binomial, <span class="at">data=</span>sesamesim)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>A vector containing estimates of the parameters:</li>
</ol>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="hands-on-examples-using-bain.html#cb172-1" aria-hidden="true" tabindex="-1"></a>estimates <span class="ot">&lt;-</span><span class="fu">coef</span>(anal)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>A list containing, per group, the covariance matrix of the parameters:</li>
</ol>
<p>Use <code>numDeriv</code> to compute the Hessian matrix and subsequently the covariance matrix for each of the two (boys and girls) groups. The vector f should contain the regression coefficient of the group at hand and the regression coefficient of the covariate.</p>
<ul>
<li>The first group:</li>
</ul>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="hands-on-examples-using-bain.html#cb173-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">cbind</span>(sesamesim<span class="sc">$</span>sex,sesamesim<span class="sc">$</span>age,sesamesim<span class="sc">$</span>viewenc),</span>
<span id="cb173-2"><a href="hands-on-examples-using-bain.html#cb173-2" aria-hidden="true" tabindex="-1"></a>sesamesim<span class="sc">$</span>sex<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb173-3"><a href="hands-on-examples-using-bain.html#cb173-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb173-4"><a href="hands-on-examples-using-bain.html#cb173-4" aria-hidden="true" tabindex="-1"></a>f[<span class="dv">1</span>] <span class="ot">&lt;-</span> estimates[<span class="dv">1</span>] <span class="co"># the regression coefficient of boys</span></span>
<span id="cb173-5"><a href="hands-on-examples-using-bain.html#cb173-5" aria-hidden="true" tabindex="-1"></a>f[<span class="dv">2</span>] <span class="ot">&lt;-</span> estimates[<span class="dv">3</span>] <span class="co"># the regression coefficient of age</span></span>
<span id="cb173-6"><a href="hands-on-examples-using-bain.html#cb173-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span></code></pre></div>
<p>Within the for loop below the log likelihood of the logistic regression model is computed using the data for the boys:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="hands-on-examples-using-bain.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co">#logist1 &lt;- function(x){</span></span>
<span id="cb174-2"><a href="hands-on-examples-using-bain.html#cb174-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#out &lt;- 0</span></span>
<span id="cb174-3"><a href="hands-on-examples-using-bain.html#cb174-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#for (i in 1:ngroup[1]){</span></span>
<span id="cb174-4"><a href="hands-on-examples-using-bain.html#cb174-4" aria-hidden="true" tabindex="-1"></a>   <span class="co"># out &lt;- out + data[i,3]*(x[1] + x[2]*data[i,2]) - log (1 +</span></span>
<span id="cb174-5"><a href="hands-on-examples-using-bain.html#cb174-5" aria-hidden="true" tabindex="-1"></a>   <span class="co"># exp(x[1] + x[2]*data[i,2]))</span></span>
<span id="cb174-6"><a href="hands-on-examples-using-bain.html#cb174-6" aria-hidden="true" tabindex="-1"></a> <span class="co"># }</span></span>
<span id="cb174-7"><a href="hands-on-examples-using-bain.html#cb174-7" aria-hidden="true" tabindex="-1"></a> <span class="co"># return(out)</span></span>
<span id="cb174-8"><a href="hands-on-examples-using-bain.html#cb174-8" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb174-9"><a href="hands-on-examples-using-bain.html#cb174-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-10"><a href="hands-on-examples-using-bain.html#cb174-10" aria-hidden="true" tabindex="-1"></a><span class="co">#hes1 &lt;- hessian(func=logist1, x=f)</span></span>
<span id="cb174-11"><a href="hands-on-examples-using-bain.html#cb174-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-12"><a href="hands-on-examples-using-bain.html#cb174-12" aria-hidden="true" tabindex="-1"></a><span class="co"># multiply with -1 and invert to obtain the covariance matrix for the</span></span>
<span id="cb174-13"><a href="hands-on-examples-using-bain.html#cb174-13" aria-hidden="true" tabindex="-1"></a><span class="co"># first group</span></span>
<span id="cb174-14"><a href="hands-on-examples-using-bain.html#cb174-14" aria-hidden="true" tabindex="-1"></a><span class="co">#cov1 &lt;- -1 * solve(hes1)</span></span>
<span id="cb174-15"><a href="hands-on-examples-using-bain.html#cb174-15" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span></code></pre></div>
<ul>
<li>The second group (repeat the same):</li>
</ul>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="hands-on-examples-using-bain.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co">#data &lt;- subset(cbind(sesamesim$sex,sesamesim$age,sesamesim$viewenc),</span></span>
<span id="cb175-2"><a href="hands-on-examples-using-bain.html#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="co">#sesamesim$sex==2)</span></span>
<span id="cb175-3"><a href="hands-on-examples-using-bain.html#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="co">#f[1] &lt;- estimates[2] # the regression coefficient of girls</span></span>
<span id="cb175-4"><a href="hands-on-examples-using-bain.html#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="co">#f[2] &lt;- estimates[3] # the regression coefficient of age</span></span></code></pre></div>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="hands-on-examples-using-bain.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co">#logist2 &lt;- function(x){</span></span>
<span id="cb176-2"><a href="hands-on-examples-using-bain.html#cb176-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#out &lt;- 0</span></span>
<span id="cb176-3"><a href="hands-on-examples-using-bain.html#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#for (i in 1:ngroup[2]){ </span></span>
<span id="cb176-4"><a href="hands-on-examples-using-bain.html#cb176-4" aria-hidden="true" tabindex="-1"></a>   <span class="co"># out &lt;- out + data[i,3]*(x[1] + x[2]*data[i,2]) - log (1 +</span></span>
<span id="cb176-5"><a href="hands-on-examples-using-bain.html#cb176-5" aria-hidden="true" tabindex="-1"></a>   <span class="co"># exp(x[1] + x[2]*data[i,2]))</span></span>
<span id="cb176-6"><a href="hands-on-examples-using-bain.html#cb176-6" aria-hidden="true" tabindex="-1"></a> <span class="co"># }</span></span>
<span id="cb176-7"><a href="hands-on-examples-using-bain.html#cb176-7" aria-hidden="true" tabindex="-1"></a> <span class="co"># return(out)</span></span>
<span id="cb176-8"><a href="hands-on-examples-using-bain.html#cb176-8" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb176-9"><a href="hands-on-examples-using-bain.html#cb176-9" aria-hidden="true" tabindex="-1"></a><span class="co">#hes2 &lt;- hessian(func=logist2, x=f)</span></span>
<span id="cb176-10"><a href="hands-on-examples-using-bain.html#cb176-10" aria-hidden="true" tabindex="-1"></a><span class="co"># multiply with -1 and invert to obtain the covariance matrix</span></span>
<span id="cb176-11"><a href="hands-on-examples-using-bain.html#cb176-11" aria-hidden="true" tabindex="-1"></a><span class="co">#cov2 &lt;- -1 * solve(hes2)</span></span></code></pre></div>
<p>Combine the covariance matrices:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="hands-on-examples-using-bain.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ovariance&lt;-list(cov1,cov2)</span></span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Per group the sample size used for estimation of the parameters:</li>
</ol>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="hands-on-examples-using-bain.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ngroup &lt;- table(sesamesim$sex)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Assign names to the estimates:</li>
</ol>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="hands-on-examples-using-bain.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co">#names(estimates) &lt;- c(&quot;boys&quot;, &quot;girls&quot;, &quot;age&quot;)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Set seed and 4) call <code>bain</code>:</li>
</ol>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="hands-on-examples-using-bain.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set.seed(100)</span></span>
<span id="cb180-2"><a href="hands-on-examples-using-bain.html#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="co">#results &lt;- bain(estimates, &quot;boys &lt; girls &amp; age &gt; 0&quot;, n=ngroup,</span></span>
<span id="cb180-3"><a href="hands-on-examples-using-bain.html#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Sigma=covariance, group_parameters=1, joint_parameters = 1)</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Print the results:</li>
</ol>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="hands-on-examples-using-bain.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co">#print(results)</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Summary: estimates and credibility intervals:</li>
</ol>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="hands-on-examples-using-bain.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(results, ci = 0.95)</span></span></code></pre></div>
</div>
<div id="cfa" class="section level3" number="3.4.9">
<h3><span class="header-section-number">3.4.9</span> CFA</h3>
<p>This option uses <code>bain.default()</code>, so the user must manually extract the required information. See the tutorial by <span class="citation"><a href="references.html#ref-van2021teacher" role="doc-biblioref">Van Lissa et al.</a> (<a href="references.html#ref-van2021teacher" role="doc-biblioref">2021</a>)</span> for further elaborations.</p>
<p>First, we fit a structural equation model using <code>lavaan</code>:</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="hands-on-examples-using-bain.html#cb183-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="st">&#39;A =~ Ab + Al + Af + An + Ar + Ac </span></span>
<span id="cb183-2"><a href="hands-on-examples-using-bain.html#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="st">           B =~ Bb + Bl + Bf + Bn + Br + Bc&#39;</span></span>
<span id="cb183-3"><a href="hands-on-examples-using-bain.html#cb183-3" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">sem</span>(model1, <span class="at">data =</span> sesamesim, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>We want to specify the following hypotheses:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="hands-on-examples-using-bain.html#cb184-1" aria-hidden="true" tabindex="-1"></a>hypotheses <span class="ot">&lt;-</span> <span class="st">&quot;(Ab, Al, Af, An, Ar, Ac) &gt;.6 &amp;</span></span>
<span id="cb184-2"><a href="hands-on-examples-using-bain.html#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="st">               (Bb, Bl, Bf, Bn, Br, Bc) &gt;.6&quot;</span></span></code></pre></div>
<p>Next, we extract the required information from the <code>lavaan</code> model object, in the order of the parameter table above:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="hands-on-examples-using-bain.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract standardized parameter estimates (argument x)</span></span>
<span id="cb185-2"><a href="hands-on-examples-using-bain.html#cb185-2" aria-hidden="true" tabindex="-1"></a>PE1 <span class="ot">&lt;-</span> <span class="fu">parameterEstimates</span>(fit1, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb185-3"><a href="hands-on-examples-using-bain.html#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify which parameter estimates are factor loadings</span></span>
<span id="cb185-4"><a href="hands-on-examples-using-bain.html#cb185-4" aria-hidden="true" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> <span class="fu">which</span>(PE1<span class="sc">$</span>op <span class="sc">==</span> <span class="st">&quot;=~&quot;</span>)</span>
<span id="cb185-5"><a href="hands-on-examples-using-bain.html#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Collect the standardized &quot;std.all&quot; factor loadings &quot;=~&quot;</span></span>
<span id="cb185-6"><a href="hands-on-examples-using-bain.html#cb185-6" aria-hidden="true" tabindex="-1"></a>estimates <span class="ot">&lt;-</span> PE1<span class="sc">$</span>std.all[loadings]</span>
<span id="cb185-7"><a href="hands-on-examples-using-bain.html#cb185-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign names to the standardized factor loadings</span></span>
<span id="cb185-8"><a href="hands-on-examples-using-bain.html#cb185-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(estimates) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Ab&quot;</span>, <span class="st">&quot;Al&quot;</span>, <span class="st">&quot;Af&quot;</span>, <span class="st">&quot;An&quot;</span>, <span class="st">&quot;Ar&quot;</span>, <span class="st">&quot;Ac&quot;</span>, </span>
<span id="cb185-9"><a href="hands-on-examples-using-bain.html#cb185-9" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Bb&quot;</span>, <span class="st">&quot;Bl&quot;</span>, <span class="st">&quot;Bf&quot;</span>, <span class="st">&quot;Bn&quot;</span>, <span class="st">&quot;Br&quot;</span>, <span class="st">&quot;Bc&quot;</span>)</span>
<span id="cb185-10"><a href="hands-on-examples-using-bain.html#cb185-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-11"><a href="hands-on-examples-using-bain.html#cb185-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract sample size (argument n)</span></span>
<span id="cb185-12"><a href="hands-on-examples-using-bain.html#cb185-12" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nobs</span>(fit1)</span>
<span id="cb185-13"><a href="hands-on-examples-using-bain.html#cb185-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-14"><a href="hands-on-examples-using-bain.html#cb185-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the standardized model parameter covariance matrix,</span></span>
<span id="cb185-15"><a href="hands-on-examples-using-bain.html#cb185-15" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting only the rows and columns for the loadings</span></span>
<span id="cb185-16"><a href="hands-on-examples-using-bain.html#cb185-16" aria-hidden="true" tabindex="-1"></a>covariance <span class="ot">&lt;-</span> <span class="fu">lavInspect</span>(fit1, <span class="st">&quot;vcov.std.all&quot;</span>)[loadings, loadings]</span>
<span id="cb185-17"><a href="hands-on-examples-using-bain.html#cb185-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-18"><a href="hands-on-examples-using-bain.html#cb185-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Give the covariance matrix the same names as the estimate</span></span>
<span id="cb185-19"><a href="hands-on-examples-using-bain.html#cb185-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(covariance) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">names</span>(estimates), <span class="fu">names</span>(estimates))</span>
<span id="cb185-20"><a href="hands-on-examples-using-bain.html#cb185-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-21"><a href="hands-on-examples-using-bain.html#cb185-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Put the covariance matrix in a list</span></span>
<span id="cb185-22"><a href="hands-on-examples-using-bain.html#cb185-22" aria-hidden="true" tabindex="-1"></a>covariance <span class="ot">&lt;-</span> <span class="fu">list</span>(covariance)</span>
<span id="cb185-23"><a href="hands-on-examples-using-bain.html#cb185-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-24"><a href="hands-on-examples-using-bain.html#cb185-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify number of group parameters; this simply means that there </span></span>
<span id="cb185-25"><a href="hands-on-examples-using-bain.html#cb185-25" aria-hidden="true" tabindex="-1"></a><span class="co"># are 12 parameters in the estimate.</span></span>
<span id="cb185-26"><a href="hands-on-examples-using-bain.html#cb185-26" aria-hidden="true" tabindex="-1"></a>group_parameters <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb185-27"><a href="hands-on-examples-using-bain.html#cb185-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-28"><a href="hands-on-examples-using-bain.html#cb185-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Then, the number of joint parameters. This is always 0 for evaluations of</span></span>
<span id="cb185-29"><a href="hands-on-examples-using-bain.html#cb185-29" aria-hidden="true" tabindex="-1"></a><span class="co"># SEM hypotheses:</span></span>
<span id="cb185-30"><a href="hands-on-examples-using-bain.html#cb185-30" aria-hidden="true" tabindex="-1"></a>joint_parameters <span class="ot">&lt;-</span> <span class="dv">0</span></span></code></pre></div>
<p>Now, we can evaluate the hypotheses using <code>bain.default()</code>:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="hands-on-examples-using-bain.html#cb186-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">bain</span>(<span class="at">x =</span> estimates,</span>
<span id="cb186-2"><a href="hands-on-examples-using-bain.html#cb186-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">hypothesis =</span> hypotheses,</span>
<span id="cb186-3"><a href="hands-on-examples-using-bain.html#cb186-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> n,</span>
<span id="cb186-4"><a href="hands-on-examples-using-bain.html#cb186-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">Sigma =</span> covariance,</span>
<span id="cb186-5"><a href="hands-on-examples-using-bain.html#cb186-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">group_parameters =</span> group_parameters,</span>
<span id="cb186-6"><a href="hands-on-examples-using-bain.html#cb186-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">joint_parameters =</span> joint_parameters)</span>
<span id="cb186-7"><a href="hands-on-examples-using-bain.html#cb186-7" aria-hidden="true" tabindex="-1"></a>res</span></code></pre></div>
<pre><code>## Bayesian informative hypothesis testing for an object of class numeric:
## 
##    Fit   Com   BF.u   BF.c    PMPa  PMPb 
## H1 0.880 0.009 93.351 768.863 1.000 0.989
## Hu                                  0.011
## 
## Hypotheses:
##   H1: (Ab,Al,Af,An,Ar,Ac)&gt;.6&amp;(Bb,Bl,Bf,Bn,Br,Bc)&gt;.6
## 
## Note: BF.u denotes the Bayes factor of the hypothesis at hand versus the unconstrained hypothesis Hu. BF.c denotes the Bayes factor of the hypothesis at hand versus its complement.</code></pre>
<p>Finally, we print the results of the bain analysis and obtain the estimates and 95%
central credibility intervals:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="hands-on-examples-using-bain.html#cb188-1" aria-hidden="true" tabindex="-1"></a>sres <span class="ot">&lt;-</span> <span class="fu">summary</span>(res, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb188-2"><a href="hands-on-examples-using-bain.html#cb188-2" aria-hidden="true" tabindex="-1"></a>sres</span></code></pre></div>
</div>
</div>
<div id="using-bain-with-missing-data" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Using <code>bain</code> with missing data<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>:</h2>
<p>Load <code>mice</code> (multiple imputation of missing data) inspect the <code>mice</code> help file to obtain further information:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="hands-on-examples-using-bain.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;mice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     cbind, rbind</code></pre>
<p>“Create” missing values in four variables from the sesamesim data set:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="hands-on-examples-using-bain.html#cb193-1" aria-hidden="true" tabindex="-1"></a>misdat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(sesamesim<span class="sc">$</span>prenumb,sesamesim<span class="sc">$</span>postnumb,sesamesim<span class="sc">$</span>funumb,sesamesim<span class="sc">$</span>peabody)</span>
<span id="cb193-2"><a href="hands-on-examples-using-bain.html#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(misdat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;prenumb&quot;</span>,<span class="st">&quot;postnumb&quot;</span>,<span class="st">&quot;funumb&quot;</span>,<span class="st">&quot;peabody&quot;</span>)</span>
<span id="cb193-3"><a href="hands-on-examples-using-bain.html#cb193-3" aria-hidden="true" tabindex="-1"></a>misdat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(misdat)</span>
<span id="cb193-4"><a href="hands-on-examples-using-bain.html#cb193-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-5"><a href="hands-on-examples-using-bain.html#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb193-6"><a href="hands-on-examples-using-bain.html#cb193-6" aria-hidden="true" tabindex="-1"></a>pmis <span class="ot">&lt;-</span> .<span class="dv">80</span></span>
<span id="cb193-7"><a href="hands-on-examples-using-bain.html#cb193-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb193-8"><a href="hands-on-examples-using-bain.html#cb193-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">240</span>){</span>
<span id="cb193-9"><a href="hands-on-examples-using-bain.html#cb193-9" aria-hidden="true" tabindex="-1"></a>  uni<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb193-10"><a href="hands-on-examples-using-bain.html#cb193-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (pmis <span class="sc">&lt;</span> uni) {</span>
<span id="cb193-11"><a href="hands-on-examples-using-bain.html#cb193-11" aria-hidden="true" tabindex="-1"></a>    misdat<span class="sc">$</span>funumb[i]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb193-12"><a href="hands-on-examples-using-bain.html#cb193-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb193-13"><a href="hands-on-examples-using-bain.html#cb193-13" aria-hidden="true" tabindex="-1"></a>  uni<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb193-14"><a href="hands-on-examples-using-bain.html#cb193-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (pmis <span class="sc">&lt;</span> uni) {</span>
<span id="cb193-15"><a href="hands-on-examples-using-bain.html#cb193-15" aria-hidden="true" tabindex="-1"></a>    misdat<span class="sc">$</span>prenumb[i]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb193-16"><a href="hands-on-examples-using-bain.html#cb193-16" aria-hidden="true" tabindex="-1"></a>    misdat<span class="sc">$</span>postnumb[i]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb193-17"><a href="hands-on-examples-using-bain.html#cb193-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb193-18"><a href="hands-on-examples-using-bain.html#cb193-18" aria-hidden="true" tabindex="-1"></a>  uni<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb193-19"><a href="hands-on-examples-using-bain.html#cb193-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (pmis <span class="sc">&lt;</span> uni) {</span>
<span id="cb193-20"><a href="hands-on-examples-using-bain.html#cb193-20" aria-hidden="true" tabindex="-1"></a>    misdat<span class="sc">$</span>peabody[i]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb193-21"><a href="hands-on-examples-using-bain.html#cb193-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb193-22"><a href="hands-on-examples-using-bain.html#cb193-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb193-23"><a href="hands-on-examples-using-bain.html#cb193-23" aria-hidden="true" tabindex="-1"></a><span class="co"># print data summaries - note the missing values (NAs)</span></span>
<span id="cb193-24"><a href="hands-on-examples-using-bain.html#cb193-24" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(misdat)</span></code></pre></div>
<pre><code>##     prenumb            postnumb         funumb         peabody        
##  Min.   :-1.86095   Min.   : 0.00   Min.   : 0.00   Min.   :-2.60009  
##  1st Qu.:-0.63654   1st Qu.:21.75   1st Qu.:17.00   1st Qu.:-0.67160  
##  Median :-0.02433   Median :28.00   Median :33.50   Median :-0.04951  
##  Mean   : 0.04348   Mean   :29.55   Mean   :34.17   Mean   : 0.06214  
##  3rd Qu.: 0.68206   3rd Qu.:38.00   3rd Qu.:46.00   3rd Qu.: 0.80587  
##  Max.   : 2.94251   Max.   :63.00   Max.   :91.00   Max.   : 2.81212  
##  NA&#39;s   :40         NA&#39;s   :40      NA&#39;s   :50      NA&#39;s   :50</code></pre>
<ol style="list-style-type: decimal">
<li>Use <code>mice</code> to create 1000 imputed data matrices. Note that, the approach used
below is only one manner in which mice can be instructed. Many other options are available:</li>
</ol>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="hands-on-examples-using-bain.html#cb195-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb195-2"><a href="hands-on-examples-using-bain.html#cb195-2" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">mice</span>(<span class="at">data =</span> misdat, <span class="at">m =</span> M, <span class="at">seed=</span><span class="dv">999</span>, <span class="at">meth=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;norm&quot;</span>), <span class="at">diagnostics =</span> <span class="cn">FALSE</span>, <span class="at">printFlag =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Create vectors in which 1000 fits and complexities can be stored for each
of two hypotheses and their complement:</li>
</ol>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="hands-on-examples-using-bain.html#cb196-1" aria-hidden="true" tabindex="-1"></a>fits1 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>,<span class="dv">1000</span>)</span>
<span id="cb196-2"><a href="hands-on-examples-using-bain.html#cb196-2" aria-hidden="true" tabindex="-1"></a>compls1 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>,<span class="dv">1000</span>)</span>
<span id="cb196-3"><a href="hands-on-examples-using-bain.html#cb196-3" aria-hidden="true" tabindex="-1"></a>fits2 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>,<span class="dv">1000</span>)</span>
<span id="cb196-4"><a href="hands-on-examples-using-bain.html#cb196-4" aria-hidden="true" tabindex="-1"></a>compls2 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>,<span class="dv">1000</span>)</span>
<span id="cb196-5"><a href="hands-on-examples-using-bain.html#cb196-5" aria-hidden="true" tabindex="-1"></a>fitscomplement <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>,<span class="dv">1000</span>)</span>
<span id="cb196-6"><a href="hands-on-examples-using-bain.html#cb196-6" aria-hidden="true" tabindex="-1"></a>complscomplement <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;numeric&quot;</span>,<span class="dv">1000</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Analyse each imputed data set with <code>lm</code> and <code>bain</code>, store the resulting fits and complexities:</li>
</ol>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="hands-on-examples-using-bain.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb197-2"><a href="hands-on-examples-using-bain.html#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M) {</span>
<span id="cb197-3"><a href="hands-on-examples-using-bain.html#cb197-3" aria-hidden="true" tabindex="-1"></a>regr <span class="ot">&lt;-</span> <span class="fu">lm</span>(funumb<span class="sc">~</span>prenumb<span class="sc">+</span>postnumb,<span class="fu">complete</span>(out,i))</span>
<span id="cb197-4"><a href="hands-on-examples-using-bain.html#cb197-4" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">bain</span>(regr,<span class="st">&quot;prenumb=0 &amp; postnumb=0;prenumb&gt;0 &amp; postnumb&gt;0&quot;</span>)  </span>
<span id="cb197-5"><a href="hands-on-examples-using-bain.html#cb197-5" aria-hidden="true" tabindex="-1"></a>fits1[i]<span class="ot">&lt;-</span>result<span class="sc">$</span>fit<span class="sc">$</span>Fit[<span class="dv">1</span>] </span>
<span id="cb197-6"><a href="hands-on-examples-using-bain.html#cb197-6" aria-hidden="true" tabindex="-1"></a>compls1[i]<span class="ot">&lt;-</span>result<span class="sc">$</span>fit<span class="sc">$</span>Com[<span class="dv">1</span>]</span>
<span id="cb197-7"><a href="hands-on-examples-using-bain.html#cb197-7" aria-hidden="true" tabindex="-1"></a>fits2[i]<span class="ot">&lt;-</span>result<span class="sc">$</span>fit<span class="sc">$</span>Fit[<span class="dv">2</span>] </span>
<span id="cb197-8"><a href="hands-on-examples-using-bain.html#cb197-8" aria-hidden="true" tabindex="-1"></a>compls2[i]<span class="ot">&lt;-</span>result<span class="sc">$</span>fit<span class="sc">$</span>Com[<span class="dv">2</span>]</span>
<span id="cb197-9"><a href="hands-on-examples-using-bain.html#cb197-9" aria-hidden="true" tabindex="-1"></a>fitscomplement[i]<span class="ot">&lt;-</span>result<span class="sc">$</span>fit<span class="sc">$</span>Fit[<span class="dv">4</span>] </span>
<span id="cb197-10"><a href="hands-on-examples-using-bain.html#cb197-10" aria-hidden="true" tabindex="-1"></a>complscomplement[i]<span class="ot">&lt;-</span>result<span class="sc">$</span>fit<span class="sc">$</span>Com[<span class="dv">4</span>]</span>
<span id="cb197-11"><a href="hands-on-examples-using-bain.html#cb197-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Compute the Bayes factor from the imputed fits and complexities see Equation 23 in <span class="citation"><a href="references.html#ref-hoijtink2019computing" role="doc-biblioref">Hoijtink, Gu, Mulder, &amp; Rosseel</a> (<a href="references.html#ref-hoijtink2019computing" role="doc-biblioref">2019</a>)</span>:</li>
</ol>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="hands-on-examples-using-bain.html#cb198-1" aria-hidden="true" tabindex="-1"></a>BF1u <span class="ot">&lt;-</span> <span class="fu">sum</span>(fits1)<span class="sc">/</span><span class="fu">sum</span>(compls1)</span>
<span id="cb198-2"><a href="hands-on-examples-using-bain.html#cb198-2" aria-hidden="true" tabindex="-1"></a>BF2u <span class="ot">&lt;-</span> <span class="fu">sum</span>(fits2)<span class="sc">/</span><span class="fu">sum</span>(compls2)</span>
<span id="cb198-3"><a href="hands-on-examples-using-bain.html#cb198-3" aria-hidden="true" tabindex="-1"></a>BFcomplementu <span class="ot">&lt;-</span> <span class="fu">sum</span>(fitscomplement)<span class="sc">/</span><span class="fu">sum</span>(complscomplement)</span>
<span id="cb198-4"><a href="hands-on-examples-using-bain.html#cb198-4" aria-hidden="true" tabindex="-1"></a>BF <span class="ot">&lt;-</span> <span class="fu">c</span>(BF1u, BF2u, BFcomplementu)</span>
<span id="cb198-5"><a href="hands-on-examples-using-bain.html#cb198-5" aria-hidden="true" tabindex="-1"></a>BF</span></code></pre></div>
<pre><code>## [1] 9.442939e-15 1.094018e+00           NA</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Compute PMPc:</li>
</ol>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="hands-on-examples-using-bain.html#cb200-1" aria-hidden="true" tabindex="-1"></a>PMPcH1 <span class="ot">&lt;-</span> BF1u<span class="sc">/</span>(BF1u <span class="sc">+</span> BF2u <span class="sc">+</span> BFcomplementu)</span>
<span id="cb200-2"><a href="hands-on-examples-using-bain.html#cb200-2" aria-hidden="true" tabindex="-1"></a>PMPcH2 <span class="ot">&lt;-</span> BF2u<span class="sc">/</span>(BF1u <span class="sc">+</span> BF2u <span class="sc">+</span> BFcomplementu)</span>
<span id="cb200-3"><a href="hands-on-examples-using-bain.html#cb200-3" aria-hidden="true" tabindex="-1"></a>PMPcHcomplement <span class="ot">&lt;-</span> BFcomplementu<span class="sc">/</span>(BF1u <span class="sc">+</span> BF2u <span class="sc">+</span> BFcomplementu)</span>
<span id="cb200-4"><a href="hands-on-examples-using-bain.html#cb200-4" aria-hidden="true" tabindex="-1"></a>PMPc <span class="ot">&lt;-</span> <span class="fu">c</span>(PMPcH1, PMPcH2, PMPcHcomplement)</span></code></pre></div>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>Running this example on your machine will take about 60 seconds<a href="hands-on-examples-using-bain.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-bain.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sensitivity-analysis-using-bain.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["gitbook-template-.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
