[["index.html", "A GitBook template Chapter 1 Introduction", " A GitBook template Nikola Sekulovski 2021-10-01 Chapter 1 Introduction This is a template GitBook based on A GitBook Example for Teaching and bookdown: Authoring Books and Technical Documents with R Markdown. This is how we would reference a book (Xie 2015). References "],["monte-carlo-simulations.html", "Chapter 2 Monte Carlo Simulations 2.1 The Confidence Interval 2.2 The Central Limit Theorem", " Chapter 2 Monte Carlo Simulations library(tidyverse) 2.1 The Confidence Interval In this exercise I will try to repeat the example given by Gerko Vink The main idea of this exercise is to illustrate the nature of the Confidence Interval as described by Neyman (1934) We set a seed to make our results reproducible: set.seed(6465) The first step is to take 100 samples (in this case of size 800) from a normal distributuon with \\(\\mu = 0\\) and \\(\\sigma = 1\\): samples &lt;-plyr::rlply(100, rnorm(800, 0, 1)) Secondly, we need to calculate for the mean of each sample: the absolute bias; standard error lower bound of the 95% confidence interval and upper bound of the 95% confidence interval. We can construct a function that does this: samp_function &lt;- function(x) { m &lt;- mean(x) n &lt;- length(x) se &lt;- 1/sqrt(n) bias &lt;- abs(-0 - m) df &lt;- n - 1 interval &lt;- qt(.975, df) * se return(c(m, bias, se, m - interval, m + interval)) } format &lt;- c(&quot;Mean&quot; = 0, &quot;Bias&quot; = 0, &quot;Std.Err&quot; = 0, &quot;Lower&quot; = 0, &quot;Upper&quot; = 0) Now we use the constructed function samp_function on all 100 samples contained in the object samples. And we also add a new column to the results that indicates which CI of the respective samples does contain \\(\\mu\\). results &lt;- samples %&gt;% vapply(., samp_function, format) %&gt;% t %&gt;% as_tibble %&gt;% mutate(Covered = ifelse(Lower &lt; 0 &amp; Upper &gt; 0, 1, 0)) We can also add a table with the sample statistics of the samples whose CIs do not contain \\(\\mu\\). results %&gt;% filter(Covered ==0) %&gt;% kableExtra::kable(caption = &quot;Here is a table of the samples&quot; ) Table 2.1: Here is a table of the samples Mean Bias Std.Err Lower Upper Covered -0.0945589 0.0945589 0.0353553 -0.1639592 -0.0251585 0 0.0740058 0.0740058 0.0353553 0.0046055 0.1434062 0 And finally we can also make a nice plot illustrating everything that we did so far. lims &lt;- aes(ymax = results$Upper, ymin = results$Lower) ggplot(results, aes(y=Mean, x=1:100, colour = Covered)) + geom_hline(aes(yintercept = 0)) + geom_pointrange(lims) + xlab(&quot;Simulations&quot;) + ylab(&quot;Means and 95% Confidence Intervals&quot;) ## Warning: Use of `results$Upper` is discouraged. Use `Upper` instead. ## Warning: Use of `results$Lower` is discouraged. Use `Lower` instead. Figure 2.1: Here is a plot of the CIs In this case only two out of 100 CIs do not include the true population mean. 2.2 The Central Limit Theorem Here we will also try to illustrate the Central Limit Theorem, in its most basic form, with a very simple example. First we draw 1000 samples (again of size 800), form , say, a Poisson distribution, of course we couldve drawn them from a uniform or an exponential as well. samples_2 &lt;- samples &lt;-plyr::rlply(1000, rpois(800, 2)) Now we calculate the mean for each sample: means &lt;- samples_2 %&gt;% lapply(., mean) %&gt;% as.data.frame() %&gt;% t() And now we plot a histogram of the resulting means: hist(t(means)) Figure 2.2: Histogram of the sampling distribution of the mean "],["equations.html", "Chapter 3 Equations 3.1 Bayes theorem 3.2 Normal PDF", " Chapter 3 Equations 3.1 Bayes theorem \\[\\begin{equation} p(\\theta | D) = \\frac{p(D|\\theta) p(\\theta)} {p(D)} \\tag{3.1} \\end{equation}\\] 3.2 Normal PDF \\[\\begin{equation} f(x) = \\frac{1}{\\sigma\\sqrt{2\\pi}}\\exp\\left(-\\frac{1}{2}\\left(\\frac{x-\\mu}{\\sigma}\\right)^{2}\\right) \\tag{3.2} \\end{equation}\\] This is how we refer to equations: -see equation (3.2) "],["references.html", "References", " References "],["appendix-a.html", "Appendix A", " Appendix A "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
